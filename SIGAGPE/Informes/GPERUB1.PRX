#INCLUDE "GPER1030.CH"
#INCLUDE "PROTHEUS.CH"
#IFNDEF CRLF
#DEFINE CRLF ( chr(13)+chr(10) )
#ENDIF

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ GPER030  ³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 	   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Emissao de Recibos de Pagamento                                 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ GPER030(void)                                             	   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                           	   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                               		   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³         ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL.                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Programador ³ Data   ³ BOPS ³  Motivo da Alteracao 		                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Pedro Eloy ³06/02/04³------		³Ajuste no retorno da funcao OpenSrc().    ³±±
±±³ Natie      ³16/03/04³F01027		³Acerto p/trazer Funcao do mes de Referec. ³±±
±±| Natie      ³08/04/04³------		³ Acerto no Driver p/Impressao             ³±±
±±| Natie      ³16/04/04³------		³ PerSemana()busca semana do Cad.Perido    ³±±
±±| Emerson GR.³27/05/04³------		³Tratamento do Cargo de Funcionario.	   ³±±
±±| Emerson    ³08/06/04³------		³Igualar variavel lEnvioOk na chamada da   ³±±
±±³            ³        ³------		³funcao GPEMail() p/ que seja atualizada.  ³±±
±±³ Pedro Eloy ³03/06/04³070926		|Ajustado o disposicionamento do nome empr.³±±
±±³            ³        ³      		|e tratado o botao cancelar no teste impres³±±
±±³ Ricardo D. ³20/08/04³Melhor		|Tratamento da data de liberacao para con- ³±±
±±³            ³        ³      		|sulta ao recibo pagto no Rh-OnLine.       ³±±
±±³ Pedro Eloy ³26/08/04³------		|Estava se perdendo ao imprimir um funciona³±±
±±³            ³        ³      		|rio onde tivesse mais de um recibo.       ³±±
±±³ Ricardo D. ³30/08/04³Melhor		|Passagem do parametro ".F." em todas as   ³±±
±±³            ³        ³      		|chamadas da funcao R030IMPR.              ³±±
±±³ Pedro Eloy ³01/09/04³073931		³Ajuste no disposicionamento do nome da    ³±±
±±³            ³        ³      		³empresa, emissao do recibo de pagamento.  ³±±
±±³Emerson     ³28/10/04³075658		³Checar parametro MV_IREFSEM para imprimir ³±±
±±³            ³        ³------		³referencias em Semanas ou Horas.		   ³±±
±±³ Ricardo D. ³12/01/05³077579		³Ajuste da impressao da mensagem do recibo.³±±
±±³ Ricardo D. ³17/01/05³FNC092		|Ajuste da impressao c.custos c/ate 20carac³±±
±±³ Ricardo D. ³04/05/05³081718		|Ajuste do tipo dos parametros do rh-online³±±
±±³            ³        ³------		³MV_TCFD???. Devem ser do tipo caracter.   ³±±
±±³Ricardo/Emer³02/06/05³FN1996		|Ajuste no teste dos parametros MV_TCFD???.³±±
±±³Emerson     ³15/12/05³------		|Ajuste para nao imprimir valor igual a 0. ³±±
±±³Emerson     ³25/04/06³------		³Criado parametro MV_AGLUTPD - Aglut.verbas³±±
±±³Emerson     ³19/06/06³------		³Criado o ponto de entrada GPR030PD.       ³±±
±±³Emerson     ³19/06/06³------		³Alteracao de aVerbasFunc para private.    ³±±
±±³Emerson     ³22/06/06³------		³Trocar elemento 15 do aVerbasFunc pelo 5. ³±±
±±³Emerson     ³23/06/06³------		³Exclusao do ponto de entrada GPR030PD e   ³±±
±±³            ³        ³------		³inclusao do ponto GP030HTM.               ³±±
±±³Mauricio T. ³13/12/06³------		³Alterado para Private cRotBlank para exe- ³±±
±±³            ³        ³------		³cutar o dbseek com Macro &.               ³±±
±±³Erika K.    ³19/03/08³      		|Ajuste para localizacao Bolivia.      	   ³±±
±±³Erika       ³26/05/08³------		³Alteracao do CH para compatibilizar dicio-³±±
±±³            ³        ³      		³narios Mexico e R 1.2.                    ³±±
±±³Marcos Kato ³06/06/08³------		³Implementação de Recibo de Pagamento      ³±±
±±³            ³        ³      		³grafico para Portugal - R.1.2             ³±±
±±³Rogerio Vaz ³25/06/08³148775		³Correcao da impressao grafica, exibia     ³±±
±±³Melonio     ³        ³      		³o recibo para cada funcionario.           ³±±
±±³Kelly       ³30/06/08³149032		³Ajuste no grupo de perguntas.             ³±±
±±³Erika       ³05/08/08³150584		³Correcao de indices para Argentina.       ³±±
±±³Abel Ribeiro³12/03/09³--5950		|Alteração para buscar tabela Municipio e  ³±±
±±³            ³        ³  		    |Estado - Localização Colombia             ³±±
±±³Mauricio T. ³17/04/09³009298/2009|Na funcao f030Roteiro - Selecao de Roteiro³±±
±±³            ³        ³      		|por fopcoes estava aplicando Alltrim no co³±±
±±³            ³        ³      		|digo selecionado. Quando o codigo nao ocu-³±±
±±³            ³        ³      		|pava o tamanho do campo o sistmea nao loca³±±
±±³            ³        ³      		|lizava as informacoes no banco            ³±±
±±³Tiago Malta ³17/11/09³   		|Localização para o pais Angola            ³±±
±±³Luciana     ³07/01/10³030318/2009|Inclusao do campo  Horas Domingo Trabajado³±±
±±³            ³        ³           |no Recibo de Pago para pais Bolivia.      ³±±
±±³Alceu P.    ³05/02/10³00284882009|Alteracao de cabecalho para Peru.         ³±±
±±³Tiago Malta ³23/02/10³00311122009|Tratamento de periodo sem roteiro para    ³±±
±±³            ³        ³           | argentina .                              ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±± Carlos Egüez   07/11/2018   Modificaion de Reporte para Union Agronegocios   ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
User Function GPERUB1(lTerminal,cFilTerminal,cMatTerminal,cProcTerminal, nRecTipo, cPerTerminal, cSemanaTerminal)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define Variaveis Locais (Basicas)                            ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Local cString:="SRA"        // alias do arquivo principal (Base)
	Local aOrd   := {STR0001,STR0002,STR0003,STR0004,STR0005} //"Matricula"###"C.Custo"###"Nome"###"Chapa"###"C.Custo + Nome"
	Local cDesc1 := STR0006		//"Emiss„o de Recibos de Pagamento."
	Local cDesc2 := STR0007		//"Ser  impresso de acordo com os parametros solicitados pelo"
	Local cDesc3 := STR0008		//"usu rio."
	Local aDriver:= ReadDriver()
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define Variaveis Locais (Programa)                           ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Local cIndCond
	Local cRotBlank := Space(GetSx3Cache( "RCH_ROTEIR", "X3_TAMANHO" ))
	Local Baseaux 	:= "S"
	Local cHtml 	:= ""
	Local cMes		:= ""
	Local cAno		:= ""

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define o numero da linha de impressão como 0                 ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	SetPrc(0,0)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define Variaveis Private(Basicas)                            ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Private aReturn  := {STR0009, 1,STR0010, 2, 2, 1, "",1 }	//"Zebrado"###"Administra‡„o"
	Private nomeprog :="GPER030"
	Private aLinha   := { }
	Private nLastKey := 0
	Private cPerg    :="GPER030"
	Private nAteLim , nBaseFgts , nFgts , nBaseIr , nBaseIrFe
	Private nNetVal , nNetHor

	Private cCompac := aDriver[1]
	Private cNormal := aDriver[2]

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define Variaveis Private(Programa)                           ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Private aLanca 		:= {}
	Private aProve 		:= {}
	Private aDesco 		:= {}
	Private aBases 		:= {}
	Private aInfo  		:= {}
	Private aCodFol		:= {}
	Private li     		:= _PROW()
	Private Titulo 		:= STR0011		//"EMISSO DE RECIBOS DE PAGAMENTOS"
	Private lEnvioOk 	:= .F.
	Private lRetCanc	:= .t.
	Private cIRefSem    := GetMv("MV_IREFSEM",,"S")
	Private aPerAberto	:= {}
	Private aPerFechado	:= {}
	Private cProcesso	:= "" // Armazena o processo selecionado na Pergunte GPR040 (mv_par01).
	Private cRoteiro	:= "" // Armazena o Roteiro selecionado na Pergunte GPR040 (mv_par02).
	Private cPeriodo	:= "" // Armazena o Periodo selecionado na Pergunte GPR040 (mv_par03).
	Private cCcto		:= ""
	Private cCond		:= ""
	Private cRot		:= ""

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define Variaveis da Impressao Grafica                        ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Private oPrint
	Private oArial08	:= TFont():New("Courier New",08,08,,.F.,,,,.T.,.F.)//Normal
	Private oArial08N	:= TFont():New("Courier New",08,08,,.T.,,,,.T.,.F.)//Negrito
	Private oArial09N	:= TFont():New("Courier New",09,09,,.T.,,,,.T.,.F.)//Negrito
	Private oArial10	:= TFont():New("Courier New",10,10,,.F.,,,,.T.,.F.)//Normal
	Private oArial10N	:= TFont():New("Courier New",10,10,,.T.,,,,.T.,.F.)//Negriot

	//AjustaSx1()	//RS

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Envia controle para a funcao SETPRINT                        ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	wnrel:="GPER030"            //Nome Default do relatorio em Disco

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Verifica se o programa foi chamado do terminal - TCF         ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	lTerminal := If( lTerminal == Nil, .F., lTerminal )

	IF !( lTerminal )
		wnrel:=SetPrint(cString,wnrel,cPerg,Titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd)
	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define a Ordem do Relatorio                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	nOrdem := IF( !( lTerminal ), aReturn[8] , 1 )

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Verifica as perguntas selecionadas                           ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Pergunte("GPER030",.F.)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Carregando variaveis mv_par?? para Variaveis do Sistema.     ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	cSemanaTerminal := IF( Empty( cSemanaTerminal ) , Space( Len( SRC->RC_SEMANA ) ) , cSemanaTerminal )
	cProcesso  := IF( !( lTerminal ), mv_par01 , cProcTerminal		)   //Processo
	cRoteiro   := IF( !( lTerminal ), mv_par02 , nRecTipo			)	//Emitir Recibos(Roteiro)
	cPeriodo   := IF( !( lTerminal ), mv_par03 , cPerTerminal		)   //Periodo
	Semana     := IF( !( lTerminal ), mv_par04 , cSemanaTerminal	)	//Numero da Semana

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Verificar se o sistema esta trabalhando com ou sem roteiro   ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	DbSelectArea( "RCH" )
	DbSetOrder( 4 )
	DbSeek(  xFilial( "RCH" ) + cProcesso + cRoteiro + cPeriodo + Semana, .F. )
	If Eof()
		DbSeek(  xFilial( "RCH" ) + cProcesso + cRotBlank + cPeriodo + Semana, .F. )
	Else
		cRotBlank := cRoteiro
	EndIf

	//Carregar os periodos abertos (aPerAberto) e/ou
	// os periodos fechados (aPerFechado), dependendo
	// do periodo (ou intervalo de periodos) selecionado
	RetPerAbertFech(cProcesso	,; // Processo selecionado na Pergunte.
	cRotBlank	,; // Roteiro selecionado na Pergunte.
	cPeriodo	,; // Periodo selecionado na Pergunte.
	Semana		,; // Numero de Pagamento selecionado na Pergunte.
	NIL			,; // Periodo Ate - Passar "NIL", pois neste relatorio eh escolhido apenas um periodo.
	NIL			,; // Numero de Pagamento Ate - Passar "NIL", pois neste relatorio eh escolhido apenas um numero de pagamento.
	@aPerAberto	,; // Retorna array com os Periodos e NrPagtos Abertos
	@aPerFechado ) // Retorna array com os Periodos e NrPagtos Fechados

	// Retorna o mes e o ano do periodo selecionado na pergunte.
	AnoMesPer(	cProcesso	,; // Processo selecionado na Pergunte.
	cRotBlank	,; // Roteiro selecionado na Pergunte.
	cPeriodo	,; // Periodo selecionado na Pergunte.
	@cMes		,; // Retorna o Mes do Processo + Roteiro + Periodo selecionado
	@cAno		 ) // Retorna o Ano do Processo + Roteiro + Periodo selecionado

	dDataRef := CTOD("01/" + cMes + "/" + cAno)
	dDataRef := If(Empty(dDataRef),CTOD("01/" + Substr(cPeriodo,5,2) + "/" + Substr(cPeriodo,1,4)),dDataRef)

	nTipRel    := IF( !( lTerminal ), mv_par05 , 3					)	//Tipo de Recibo (Pre/Zebrado/EMail)
	cFilDe     := IF( !( lTerminal ), mv_par06,cFilTerminal		)	//Filial De
	cFilAte    := IF( !( lTerminal ), mv_par07,cFilTerminal		)	//Filial Ate
	cCcDe      := IF( !( lTerminal ), mv_par08,SRA->RA_CC			)	//Centro de Custo De
	cCcAte     := IF( !( lTerminal ), mv_par09,SRA->RA_CC			)	//Centro de Custo Ate
	cMatDe     := IF( !( lTerminal ), mv_par10,cMatTerminal		)	//Matricula Des
	cMatAte    := IF( !( lTerminal ), mv_par11,cMatTerminal		)	//Matricula Ate
	cNomDe     := IF( !( lTerminal ), mv_par12,SRA->RA_NOME		)	//Nome De
	cNomAte    := IF( !( lTerminal ), mv_par13,SRA->RA_NOME		)	//Nome Ate
	ChapaDe    := IF( !( lTerminal ), mv_par14,SRA->RA_CHAPA 		)	//Chapa De
	ChapaAte   := IF( !( lTerminal ), mv_par15,SRA->RA_CHAPA 		)	//Chapa Ate
	Mensag1    := mv_par16										 	//Mensagem 1
	Mensag2    := mv_par17											//Mensagem 2
	Mensag3    := mv_par18											//Mensagem 3
	cSituacao  := IF( !( lTerminal ),mv_par19, fSituacao( NIL , .F. ) )	//Situacoes a Imprimir
	cCategoria := IF( !( lTerminal ),mv_par20, fCategoria( NIL , .F. ))	//Categorias a Imprimir
	cBaseAux   := If(mv_par21 == 1,"S","N")							//Imprimir Bases
	cSecDe     := IF( !( lTerminal ), mv_par22,cMatTerminal		)	//Sector Des
	cSecAte    := IF( !( lTerminal ), mv_par23,cMatTerminal		)	//Sector Ate

	If nTipRel == 1 .AND. cPaisLoc = "BOL"
		nTipRel := 2
	Endif

	If aReturn[5] == 1 .and. nTipRel == 1
		li	:=  0
	EndIf

	cMesAnoRef := StrZero(Month(dDataRef),2) + StrZero(Year(dDataRef),4)
	IF !( lTerminal )
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Inicializa Impressao                                         ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If ! fInicia(cString,nTipRel)
			Return
		Endif
	Else

	EndIF

	DbSelectArea( "SRA" )
	IF nTipRel==3
		IF lTerminal
			cHtml := R030Imp(.F.,wnRel,cString,cMesAnoRef,lTerminal)
		Else
			ProcGPE({|lEnd| R030IMP(@lEnd,wnRel,cString,cMesAnoRef,.f.)},,,.T.)  // Chamada do Processamento
		EndIF
	Else
		RptStatus({|lEnd| R030Imp(@lEnd,wnRel,cString,cMesAnoRef,.f.)},Titulo)  // Chamada do Relatorio
	EndIF

Return( IF( lTerminal , cHtml , NIL ) )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ R030IMP  ³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Processamento Para emissao do Recibo                       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ R030Imp(lEnd,WnRel,cString,cMesAnoRef,lTerminal)			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function R030Imp(lEnd,WnRel,cString,cMesAnoRef,lTerminal)
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define Variaveis Locais (Basicas)                            ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	Local aCodBenef   := {}
	Local cAcessaSR1  := &("{ || " + ChkRH("GPER030","SR1","2") + "}")
	Local cAcessaSRA  := &("{ || " + ChkRH("GPER030","SRA","2") + "}")
	Local cAcessaSRC  := &("{ || " + ChkRH("GPER030","SRC","2") + "}")
	Local cAcessaSRD  := &("{ || " + ChkRH("GPER030","SRD","2") + "}")
	Local cNroHoras   := &("{ || If(aVerbasFunc[nReg,5] > 0 .And. cIRefSem == 'S', aVerbasFunc[nReg,5], aVerbasFunc[nReg,6]) }")
	Local cHtml		  := ""
	Local nHoras      := 0
	Local nMes, nAno
	Local nX
	Local nReg		  := 0
	Local cPerAnt	  := ""
	Local cKey		  := ""
	Local cInicio	  := ""

	Local dDataLibRh
	Local cPerCorrente	:= ""
	Local cSemCorrente	:= ""
	Local cMesCorrente 	:= ""
	Local cAnoCorrente 	:= ""

	Local nTcfDadt		:= if(lTerminal,getmv("MV_TCFDADT",,0),0)		// indica o dia a partir do qual esta liberada a consulta ao TCF
	Local nTcfDfol		:= if(lTerminal,getmv("MV_TCFDFOL",,0),0)		// indica a quantidade de dias a somar ou diminuir no ultimo dia do mes corrente para liberar a consulta do TCF
	Local nTcfD131		:= if(lTerminal,getmv("MV_TCFD131",,0),0)		// indica o dia a partir do qual esta liberada a consulta ao TCF
	Local nTcfD132		:= if(lTerminal,getmv("MV_TCFD132",,0),0)		// indica o dia a partir do qual esta liberada a consulta ao TCF
	Local nTcfDext		:= if(lTerminal,getmv("MV_TCFDEXT",,0),0)		// indica o dia a partir do qual esta liberada a consulta ao TCF

	Private tamanho     := "M"
	Private limite		:= 132
	Private cDtPago     := ""
	Private cPict1		:= "@E 999,999,999.99"
	Private cPict2 		:= "@E 99,999,999.99"
	Private cPict3 		:= "@E 999,999.99"
	Private cPict4 		:= "@E 999,999"
	Private cTipoRot 	:= PosAlias("SRY", cRoteiro, SRA->RA_FILIAL, "RY_TIPO")
	Private aVerbasFunc := {}
	Private cRotBlank
	Private nHraExtra 	:= 0
	Private nPagoDom	:= 0

	If MsDecimais(1) == 0
		cPict1	:=	"@E 99,999,999,999"
		cPict2 	:=	"@E 9,999,999,999"
		cPict3 	:=	"@E 99,999,999"
	Endif

	// Ajuste do tipo da variavel
	nTcfDadt	:= if(valtype(ntcfdadt)=="C",val(ntcfdadt),ntcfdadt)
	nTcfD131	:= if(valtype(nTcfD131)=="C",val(nTcfD131),nTcfD131)
	nTcfD132	:= if(valtype(nTcfD132)=="C",val(nTcfD132),nTcfD132)
	nTcfDfol	:= if(valtype(ntcfdfol)=="C",val(ntcfdfol),ntcfdfol)
	nTcfDext	:= if(valtype(ntcfdext)=="C",val(ntcfdext),ntcfdext)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//| Verifica se o Mes solicitado esta liberado para consulta no  |
	//| terminal de consulta do funcionario.                         |
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If lTerminal

		dbSelectArea("RCH")
		dbSetOrder(6)
		cKey    := "xFilial('RCH') + cProcesso" + IIf(cRoteiro == "EXT", "", " + cRoteiro")
		cInicio := "RCH_FILIAL + RCH_PROCES" + IIf(cRoteiro == "EXT", "", " + RCH_ROTEIR")

		DbSeek( &(cKey))
		If Eof()
			cRotBlank 	:= Space(GetSx3Cache( "RCH_ROTEIR", "X3_TAMANHO" ))
			cKey := "xFilial('RCH') + cProcesso " + IIf(cRoteiro == "EXT", "", " + cRotBlank")
			cInicio := "RCH_FILIAL + RCH_PROCES " + IIf(cRoteiro == "EXT", "", " + RCH_ROTEIR")
			DbSeek( &(cKey))
		EndIf
		If !Eof()
			While RCH->( !Eof() .and. &(cInicio) == &(cKey))
				If Empty(RCH->RCH_DTFECH)
					cPerCorrente := RCH->RCH_PER
					cSemCorrente := RCH->RCH_NUMPAG
					cMesCorrente := RCH->RCH_MES
					cAnoCorrente := RCH->RCH_ANO
					Exit
				EndIf
				RCH->( dbSkip() )
			EndDo
		EndIf

		If	(cPerCorrente == cPeriodo .AND. cSemCorrente == Semana)  .OR. ;
		( MesAno(dDataRef) >= (cAnoCorrente + cMesCorrente) )

			If  cTipoRot == "2" //Adiantamento
				If ( MesAno(dDataRef) > (cAnoCorrente + cMesCorrente) ) .Or.;
				( If(MesAno(Date()) == (cAnoCorrente + cMesCorrente), Day(Date()) < nTCFDADT,.F.) )
					Return( IF( lTerminal <> NIL .And. lTerminal , cHtml , NIL ) )
				EndIf
			ElseIf cTipoRot == "1" .and. !empty(nTCFDFOL) //Folha
				dDataLibRh := fMontaDtTcf(cMesCorrente + cAnoCorrente,nTCFDFOL)
				If Date() < dDataLibRH
					Return( IF( lTerminal <> NIL .And. lTerminal , cHtml , NIL ) )
				Endif
			ElseIf cTipoRot == "5" //1a parcela 13o Salario
				If ( MesAno(dDataRef) > (cAnoCorrente + cMesCorrente) ) .Or.;
				( If(MesAno(Date()) == (cAnoCorrente + cMesCorrente), Day(Date()) < nTCFD131,.F.) )
					Return( IF( lTerminal <> NIL .And. lTerminal , cHtml , NIL ) )
				Endif
			ElseIf cTipoRot == "6" //2a parcela 13o Salario
				If ( MesAno(dDataRef) > (cAnoCorrente + cMesCorrente) ) .Or.;
				( If(MesAno(Date()) == (cAnoCorrente + cMesCorrente), Day(Date()) < nTCFD132,.F.) )
					Return( IF( lTerminal <> NIL .And. lTerminal , cHtml , NIL ) )
				Endif
			ElseIf cRoteiro == "EXT"  // Valores Extras
				If ( MesAno(dDataRef) > (cAnoCorrente + cMesCorrente) ) .Or.;
				( If(MesAno(Date()) == (cAnoCorrente + cMesCorrente), Day(Date()) < nTCFDEXT,.F.) )
					Return( IF( lTerminal <> NIL .And. lTerminal , cHtml , NIL ) )
				Endif
			EndIf
		Endif
	Endif

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Selecionando a Ordem de impressao escolhida no parametro.    ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	dbSelectArea( "SRA")
	IF !( lTerminal )
		If nOrdem == 1
			dbSetOrder(1)
		ElseIf nOrdem == 2
			dbSetOrder(2)
		ElseIf nOrdem == 3
			dbSetOrder(3)
		Elseif nOrdem == 4
			cArqNtx  := CriaTrab(NIL,.f.)
			cIndCond :="RA_Filial + RA_Chapa + RA_Mat"
			IndRegua("SRA",cArqNtx,cIndCond,,,STR0012)		//"Selecionando Registros..."
		ElseIf nOrdem == 5
			dbSetOrder(8)
		Endif

		dbGoTop()

		If nTipRel == 2
			@ LI,00 PSAY AvalImp(Limite)
		Endif
	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Selecionando o Primeiro Registro e montando Filtro.          ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If nOrdem == 1 .or. lTerminal
		cInicio := "SRA->RA_FILIAL + SRA->RA_MAT"
		IF !( lTerminal )
			dbSeek(cFilDe + cMatDe,.T.)
			cFim    := cFilAte + cMatAte
		Else
			cFim    := &(cInicio)
		EndIF
	ElseIf nOrdem == 2
		dbSeek(cFilDe + cCcDe + cMatDe,.T.)
		cInicio  := "SRA->RA_FILIAL + SRA->RA_CC + SRA->RA_MAT"
		cFim     := cFilAte + cCcAte + cMatAte
	ElseIf nOrdem == 3
		dbSeek(cFilDe + cNomDe + cMatDe,.T.)
		cInicio := "SRA->RA_FILIAL + SRA->RA_NOME + SRA->RA_MAT"
		cFim    := cFilAte + cNomAte + cMatAte
	ElseIf nOrdem == 4
		dbSeek(cFilDe + ChapaDe + cMatDe,.T.)
		cInicio := "SRA->RA_FILIAL + SRA->RA_CHAPA + SRA->RA_MAT"
		cFim    := cFilAte + ChapaAte + cMatAte
	ElseIf nOrdem == 5
		dbSeek(cFilDe + cCcDe + cNomDe,.T.)
		cInicio  := "SRA->RA_FILIAL + SRA->RA_CC + SRA->RA_NOME"
		cFim     := cFilAte + cCcAte + cNomAte
	Endif

	dbSelectArea("SRA")
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Carrega Regua Processamento                                  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	IF nTipRel # 3
		SetRegua(RecCount())	// Total de elementos da regua
	Else
		IF !( lTerminal )
			GPProcRegua(RecCount())// Total de elementos da regua
		EndIF
	EndIF

	TOTVENC:= TOTDESC:= FLAG:= CHAVE := 0

	Desc_Fil := Desc_End := DESC_CC:= DESC_FUNC:= ""
	Desc_Comp:= Desc_Est := Desc_Cid:= ""
	DESC_MSG1:= DESC_MSG2:= DESC_MSG3:= Space(01)
	cFilialAnt := "  "
	Vez        := 0
	OrdemZ     := 0

	If nTipRel == 2 .and. !( lTerminal )
		If cPaisLoc=="PTG" .OR. cPaisLoc=="BOL"	//RS
			oPrint:= TMSPrinter():New(Titulo)//Emissao de Recibos de Pagamentos
			oPrint:SetPortrait()            //Define que a impressao deve ser RETRATO//
		Endif
	Endif

	While SRA->( !Eof() .And. &cInicio <= cFim )

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Movimenta Regua Processamento                                ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		IF !( lTerminal )

			IF nTipRel # 3
				IncRegua()  // Anda a regua
			ElseIF !( lTerminal )
				GPIncProc(SRA->RA_FILIAL+" - "+SRA->RA_MAT+" - "+SRA->RA_NOME)
			EndIF

			If lEnd
				@Prow()+1,0 PSAY cCancel
				Exit
			Endif

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Consiste Parametrizacao do Intervalo de Impressao            ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If	(SRA->RA_CHAPA < ChapaDe) .Or. (SRA->Ra_CHAPa > ChapaAte) .Or. ;
			(SRA->RA_NOME < cNomDe)   .Or. (SRA->Ra_NOME > cNomAte)   .Or. ;
			(SRA->RA_MAT < cMatDe)    .Or. (SRA->Ra_MAT > cMatAte)    .Or. ;
			(SRA->RA_CC < cCcDe)      .Or. (SRA->Ra_CC > cCcAte)      .Or. ;
			(SRA->RA_DEPTO < cSecDe)  .Or. (SRA->RA_DEPTO > cSecAte)
				SRA->(dbSkip(1))
				Loop
			EndIf

		EndIF

		aLanca:={}         // Zera Lancamentos
		aProve:={}         // Zera Lancamentos
		aDesco:={}         // Zera Lancamentos
		aBases:={}         // Zera Lancamentos
		nAteLim := nBaseFgts := nFgts := nBaseIr := nBaseIrFe := 0.00
		nNetVal := 0
		nNetHor := 0

		Ordem_rel := 1     // Ordem dos Recibos

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Verifica Data Demissao         ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		cSitFunc := SRA->RA_SITFOLH
		dDtPesqAf:= CTOD("01/" + Left(cMesAnoRef,2) + "/" + Right(cMesAnoRef,4),"DDMMYY")
		If cSitFunc == "D" .And. (!Empty(SRA->RA_DEMISSA) .And. MesAno(SRA->RA_DEMISSA) > MesAno(dDtPesqAf))
			cSitFunc := " "
		Endif

		IF !( lTerminal )

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Consiste situacao e categoria dos funcionarios			     |
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If !( cSitFunc $ cSituacao ) .OR.  ! ( SRA->RA_CATFUNC $ cCategoria )
				dbSkip()
				Loop
			Endif
			If cSitFunc $ "D" .And. Mesano(SRA->RA_DEMISSA) # Mesano(dDataRef)
				dbSkip()
				Loop
			Endif

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Consiste controle de acessos e filiais validas				 |
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If !(SRA->RA_FILIAL $ fValidFil()) .Or. !Eval(cAcessaSRA)
				dbSkip()
				Loop
			EndIf

		EndIF

		If SRA->RA_Filial # cFilialAnt
			If ! Fp_CodFol(@aCodFol,Sra->Ra_Filial) .Or. ! fInfo(@aInfo,Sra->Ra_Filial)
				Exit
			Endif
			Desc_Fil := aInfo[3]
			Desc_End := aInfo[4]                // Dados da Filial
			Desc_CGC := aInfo[8]
			DESC_MSG1:= DESC_MSG2:= DESC_MSG3:= Space(01)
			Desc_Est := Substr(fDesc("SX5","12"+aInfo[6],"X5DESCRI()"),1,12)
			Desc_Comp:= aInfo[14]        			// Complemento Cobranca
			Desc_Cid := aInfo[05]
			// MENSAGENS
			If MENSAG1 # SPACE(3)
				If FPHIST82(SRA->RA_FILIAL,"06",MENSAG1)
					DESC_MSG1 := Left(SRX->RX_TXT,30)
				Endif
			Endif

			If MENSAG2 # SPACE(3)
				If FPHIST82(SRA->RA_FILIAL,"06",MENSAG2)
					DESC_MSG2 := Left(SRX->RX_TXT,30)
				Endif
			Endif

			If MENSAG3 # SPACE(3)
				If FPHIST82(SRA->RA_FILIAL,"06",MENSAG3)
					DESC_MSG3 := Left(SRX->RX_TXT,30)
				Endif
			Endif
			dbSelectArea("SRA")
			cFilialAnt := SRA->RA_FILIAL
		Endif

		Totvenc := Totdesc := 0

		//Retorna as verbas do funcionario, de acordo com os periodos selecionados
		aVerbasFunc	:= RetornaVerbasFunc(	SRA->RA_FILIAL					,; // Filial do funcionario corrente
		SRA->RA_MAT	  					,; // Matricula do funcionario corrente
		NIL								,; //
		cRoteiro	  					,; // Roteiro selecionado na pergunte
		NIL			  					,; // Array com as verbas que deverão ser listadas. Se NIL retorna todas as verbas.
		aPerAberto	  					,; // Array com os Periodos e Numero de pagamento abertos
		aPerFechado	 	 				 ) // Array com os Periodos e Numero de pagamento fechados

		If cRoteiro <> "EXT"
			For nReg := 1 to Len(aVerbasFunc)
				If (Len(aPerAberto) > 0 .AND. !Eval(cAcessaSRC)) .OR. (Len(aPerFechado) > 0 .AND. !Eval(cAcessaSRD)) .Or.;
				( aVerbasFunc[nReg,7] <= 0 )
					dbSkip()
					Loop
				EndIf

				If cPaisLoc $ "ANG" .AND. cBaseAux = "N"
					if PosSrv( aVerbasFunc[nReg,3] , SRA->RA_FILIAL , "RV_TIPOCOD" ) $ "34"
						dbSkip()
						Loop
					Endif
				Endif

				If PosSrv( aVerbasFunc[nReg,3] , SRA->RA_FILIAL , "RV_TIPOCOD" ) == "1"
					//				If cPaisLoc == "PAR" .and. Eval(cNroHoras) == 30
					//					LocGHabRea(Ctod("01/"+SubStr(DTOC(dDataRef),4)), Ctod(StrZero(F_ULTDIA(dDataRef),2)+"/"+Strzero(Month(dDataRef),2)+"/"+right(str(Year(dDataRef)),2),"ddmmyy"),@nHoras)
					//				Else
					nHoras := Eval(cNroHoras)
					//				Endif
					U_fSomaPdRec("P",aVerbasFunc[nReg,3],nHoras,aVerbasFunc[nReg,7])

					TOTVENC += aVerbasFunc[nReg,7]

					If cPaisLoc == "BOL"       //soma Horas Extras para localizacao Bolivia
						If PosSrv(aVerbasFunc[nReg,3], SRA->RA_FILIAL, "RV_HE") == "S"
							nHraExtra:= nHraExtra + aVerbasFunc[nReg,6]
						Endif
						//Soma a verba de Horas Trabalhadas no Domingo id 0779

						If (aVerbasFunc[nReg,3] == aCodFol[779,1])
							nPagoDom:= nPagoDom + aVerbasFunc[nReg,6]
						Endif
					Endif

				Elseif SRV->RV_TIPOCOD == "2"
					U_fSomaPdRec("D",aVerbasFunc[nReg,3],Eval(cNroHoras),aVerbasFunc[nReg,7])
					TOTDESC += aVerbasFunc[nReg,7]
				Elseif SRV->RV_TIPOCOD $ "3/4"
					//No Paraguai imprimir somente o valor liquido
					If cPaisLoc <> "PAR" .Or. (aVerbasFunc[nReg,3] == aCodFol[047,1])
						U_fSomaPdRec("B",aVerbasFunc[nReg,3],Eval(cNroHoras),aVerbasFunc[nReg,7])
					Endif
				Endif

				If (aVerbasFunc[nReg,3] $ aCodFol[10,1]+'*'+aCodFol[15,1]+'*'+aCodFol[27,1])
					nBaseIr += aVerbasFunc[nReg,7]
				ElseIf (aVerbasFunc[nReg,3] $ aCodFol[13,1]+'*'+aCodFol[19,1])
					nAteLim += aVerbasFunc[nReg,7]
				Elseif (aVerbasFunc[nReg,3] $ aCodFol[108,1]+'*'+aCodFol[17,1])
					nBaseFgts += aVerbasFunc[nReg,7]
				Elseif (aVerbasFunc[nReg,3] $ aCodFol[109,1]+'*'+aCodFol[18,1])
					nFgts += aVerbasFunc[nReg,7]
				Elseif (aVerbasFunc[nReg,3] == aCodFol[16,1])
					nBaseIrFe += aVerbasFunc[nReg,7]
				Endif
			Next nReg

			//RS Verifica si el concepto 998 es negativo.
			If TOTDESC > TOTVENC
				If Len(aPerAberto) > 0
					nNetVal := GetAdvFVal("SRC","RC_VALOR",xFilial("SRC")+SRA->RA_MAT+fGetCodFol("0126"),1,0)
					nNetHor := GetAdvFVal("SRC","RC_HORAS",xFilial("SRC")+SRA->RA_MAT+fGetCodFol("0126"),1,0)
				ElseIf Len(aPerFechado) > 0
					nNetVal := GetAdvFVal("SRD","RD_VALOR",xFilial("SRD")+SRA->RA_MAT+cPeriodo+fGetCodFol("0126"),1,0)
					nNetHor := GetAdvFVal("SRD","RD_HORAS",xFilial("SRD")+SRA->RA_MAT+cPeriodo+fGetCodFol("0126"),1,0)
				endif
				If nNetVal < 0
					U_fSomaPdRec("D",fGetCodFol("0126"),nNetHor,nNetVal)
					TOTDESC += nNetVal
				endif
			EndIf
		Elseif cRoteiro == "EXT"
			dbSelectArea("SR1")
			dbSetOrder(1)
			If dbSeek( SRA->RA_FILIAL + SRA->RA_MAT )
				While !Eof() .And. SRA->RA_FILIAL + SRA->RA_MAT ==	SR1->R1_FILIAL + SR1->R1_MAT
					If Semana # "99"
						If SR1->R1_SEMANA # Semana
							dbSkip()
							Loop
						Endif
					Endif
					If !Eval(cAcessaSR1)
						dbSkip()
						Loop
					EndIf
					If PosSrv( SR1->R1_PD , SRA->RA_FILIAL , "RV_TIPOCOD" ) == "1"
						U_fSomaPdRec("P",SR1->R1_PD,SR1->R1_HORAS,SR1->R1_VALOR)
						TOTVENC = TOTVENC + SR1->R1_VALOR
					Elseif SRV->RV_TIPOCOD == "2"
						U_fSomaPdRec("D",SR1->R1_PD,SR1->R1_HORAS,SR1->R1_VALOR)
						TOTDESC = TOTDESC + SR1->R1_VALOR
					Elseif SRV->RV_TIPOCOD $ "3/4"
						U_fSomaPdRec("B",SR1->R1_PD,SR1->R1_HORAS,SR1->R1_VALOR)
					Endif
					dbskip()
				Enddo
			Endif
		Endif

		dbSelectArea("SRA")

		If TOTVENC = 0 .And. TOTDESC = 0
			dbSkip()
			Loop
		Endif

		If nTipRel == 1 .and. !( lTerminal )
			fImpressao()   // Impressao do Recibo de Pagamento
			IF !( lTerminal )
				If Vez = 0  .and. nTipRel # 3  .and. aReturn[5] # 1
					//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
					//³ Descarrega teste de impressao                                ³
					//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
					fImpTeste(cString)
					If !lRetCanc
						Exit
					Endif
					TotDesc := TotVenc := 0
					If nTipRel == 2
						Loop
					Endif

				ENDIF
			EndIF
		ElseIf nTipRel == 2 .and. !( lTerminal )
			For nX := 1 to If(cPaisLoc <> "ARG",1,2)
				If cPaisLoc=="PTG"
					fImpreGraf()
				Else
					fImpreZebr()
				Endif
			Next nX
			ASize(AProve,0)
			ASize(ADesco,0)
			ASize(aBases,0)
		ElseIf nTipRel == 3 .or. lTerminal
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Ponto de entrada para alterar layout do recibo.				 |
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If ExistBlock("GP030HTM")
				cHtml := ExecBlock("GP030HTM",.F.,.F.)
			Else
				cHtml := fSendDPgto(lTerminal)   //Monta o corpo do e-mail e envia-o
			Endif
		Endif

		dbSelectArea("SRA")
		SRA->( dbSkip() )
		TOTDESC := TOTVENC := 0

	EndDo

	If nTipRel == 2 .and. !( lTerminal )
		If cPaisLoc=="PTG" .OR. cPaisLoc=="BOL"	//RS
			oPrint:Preview()
		Endif
	Endif

	IF !( lTerminal ).And.cPaisLoc<>"PTG"
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Termino do relatorio                                         ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		dbSelectArea("SRC")
		dbSetOrder(1)          // Retorno a ordem 1
		dbSelectArea("SRD")
		dbSetOrder(1)          // Retorno a ordem 1
		dbSelectArea("SRA")
		SET FILTER TO
		RetIndex("SRA")

		If !(Type("cArqNtx") == "U")
			fErase(cArqNtx + OrdBagExt())
		Endif

		Set Device To Screen

		If lEnvioOK
			APMSGINFO(STR0042)
		ElseIf nTipRel== 3
			APMSGINFO(STR0043)
		EndIf
		SeTPgEject(.F.)
		nlin:= 0
		If aReturn[5] = 1 .and. nTipRel # 3
			/*	Set Printer To
			Commit
			ourspool(wnrel)*/	//RS
		Endif

		MS_FLUSH()

	EndIF

Return( cHtml )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fImpressao³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ IMRESSAO DO RECIBO FORMULARIO CONTINUO                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fImpressao()                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fImpressao()

	Local lLinhaRoda := .T.	// Variavel que informa se foram impressas todas as linhas do miolo do recibo.
	Local nConta  := 0
	Local nContr  := 0
	Local nContrT :=0
	Private nLinhas:=16              // Numero de Linhas do Miolo do Recibo

	Ordem_Rel := 1

	fCabec()

	For nConta = 1 To Len(aLanca)
		fLanca(nConta)
		nContr ++
		nContrT ++
		If nContr = nLinhas .And. nContrT < Len(aLanca)
			nContr:=0
			Ordem_Rel ++
			fContinua()
			fCabec()
		Endif
	Next nConta
	Li:=Li -1
	Li+=IF( lLinhaRoda := (nLinhas-nContr) == 0,1,(nLinhas-nContr))
	fRodape(lLinhaRoda)

Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fImpreZebr³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ IMRESSAO DO RECIBO FORMULARIO ZEBRADO                      ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fImpreZebr()                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fImpreZebr()

	Local nConta    := nContr := nContrT:=0

	If li >= 60
		li := 0
	Endif
	if cPaisLoc == "BOL"
		fCabecZBol()
		//Else
		//fCabecZ()
	Endif
	If cPaisLoc == "BOL"
		//	fLancaZBol(nConta)	//RS
		oPrint:EndPage()
		//Else
		//fLancaZ(nConta)
	Endif

Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fImpreGraf³ Autor ³ SSERVICE				³ Data ³ 05.05.08 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ IMRESSAO DO RECIBO FORMULARIO GRAFICO                      ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fImpreGraf()                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fImpreGraf()

	Local nConta    := nContr := nContrT:=0

	//fcabecg()
	fLancaG(nConta)

Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fCabec    ³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ IMRESSAO Cabe‡alho Form Continuo                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fCabec()                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fCabec()   		// Cabecalho do Recibo
	Local cCodFunc		:= ""		//-- codigo da Funcao do funcionario
	Local cDescFunc		:= ""		//-- Descricao da Funcao do Funcionario
	Local cDescRot		:= PosAlias("SRY", cRoteiro, SRA->RA_FILIAL, "RY_DESC")

	/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Carrega Funcao do Funcion. de acordo com a Dt Referencia     ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	fBuscaFunc(dDataRef, @cCodFunc, @cDescFunc   )

	@ PROW(),PCOL() PSAY ""
	LI ++
	@ LI,01 PSAY &cNormal+DESC_Fil
	LI ++
	@ LI,01 PSAY DESC_END
	LI ++
	@ LI,01 PSAY DESC_CGC
	@ LI,20 PSAY "- " + cDescRot + " - " + cPeriodo+"/"+Semana

	LI +=2
	@ LI,01 PSAY SRA->RA_Mat
	@ LI,08 PSAY Left(SRA->RA_NOME,28)
	@ LI,37 PSAY fCodCBO(SRA->RA_FILIAL,cCodFunc ,dDataRef)
	@ LI,44 PSAY SRA->RA_Filial
	@ LI,47 PSAY PADC(ALLTRIM(SRA->RA_CC),20)
	@ LI,67 PSAY ORDEM_REL PICTURE "99"
	LI ++

	cDet := STR0015       + cCodFunc						//-- Funcao
	cDet += cDescFunc     + ' '
	cDet += DescCc(SRA->RA_CC,SRA->RA_FILIAL) + ' '
	cDet += STR0016 + SRA->RA_CHAPA					//'CHAPA: '
	@ Li,01 pSay cDet

	Li += 3 //2
Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fCabecZBolºAutor  ³Erika               º Data ³  19/03/08   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Impressao do Cabecalho - Bolivia                           º±±
±±º          ³ Zebrado                                                    º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP6                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fCabecZBol()
	Local cCodFunc		:= ""		//-- codigo da Funcao do funcionario
	Local cDescFunc		:= ""		//-- Descricao da Funcao do Funcionario
	//Local cDepto        := ""
	Local nTc			:= 0		//-- T. C.
	Local dData         := "00/00/00"
	Local nCreIva		:= 0		//RS

	Local cCodFunc		:= ""		//-- codigo da Funcao do funcionario
	Local cDescFunc		:= ""		//-- Descricao da Funcao do Funcionario
	Local cStartPath	:= GetSrvProfString("Startpath","")
	
	Private cIngrPD	:= "R01"
	Private cIngresos	:= "OTROS INGRESOS"
	Private cDescPd	:= "D01"
	Private cDescuento:= "ANTICIPOS"

	oPrint:StartPage()
	//cFLogo := cStartPath + "LGBPA1"+Subs(SM0->M0_CODFIL,1,4)+".bmp"
	cFLogo := cStartPath + "Union02.png" //+Subs(SM0->M0_CODFIL,1,4)+".bmp"
	cFLogo2:= cStartPath + "PictureGris.png"//+Subs(SM0->M0_CODFIL,1,4)+".bmp"
	cFLogo3:= cStartPath + "PictureGris.png"//+Subs(SM0->M0_CODFIL,1,4)+".bmp"

	/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Carrega Funcao do Funcion. de acordo com a Dt Referencia     ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	fBuscaFunc(dDataRef, @cCodFunc, @cDescFunc)

	/*
	//calcula o ultimo dia do mes do Periodo selecionado para buscar o campo nTc
	dData:=  F_UltDia(dDataRef)
	dData:= DaySum( dDataRef , dData-Day(dDataRef) )
	nTc := fTabela( "S009", 1, 5, dData)

	LI++
	@ LI,00  PSAY "|"
	@ LI,100 PSAY STR0141 + Transform(nTc, "99.99999") 		//T.C.:
	@ LI,131 PSAY "|"*/

	//carrega departamento
	//cDepto:= fDesc("CTT", SRA->RA_CC, "CTT->CTT_DESC01", 30)

	//carrega IVA mes siguiente y dias trabajados	//RS
	If Len(aPerAberto) > 0
		nCreIva := GetAdvFVal("SRC","RC_VNAOAPL",XFILIAL("SRC")+SRA->RA_MAT+fGetCodFol("0733"),1,"0.00")
		//	nDiaTra := GetAdvFVal("SRC","RC_HORAS",XFILIAL("SRC")+SRA->RA_MAT+"001",1,0)
		//	nDiaTra := If( nDiaTra == 0, GetAdvFVal("SRC","RC_HORAS",XFILIAL("SRC")+SRA->RA_MAT+"003",1,0), nDiaTra )
	ElseIf Len(aPerFechado) > 0
		nCreIva := GetAdvFVal("SRD","RD_VNAOAPL",XFILIAL("SRD")+SRA->RA_MAT+cPeriodo+fGetCodFol("0733"),1,"0.00")
		//	nDiaTra := GetAdvFVal("SRD","RD_HORAS",XFILIAL("SRD")+SRA->RA_MAT+cPeriodo+"001",1,0)
		//	nDiaTra := If( nDiaTra == 0, GetAdvFVal("SRD","RD_HORAS",XFILIAL("SRD")+SRA->RA_MAT+cPeriodo+"003",1,0), nDiaTra )
	EndIf

	getValoresAgrupados()
	fLancaZBol(0, cFLogo, cFLogo2, cFLogo3, nCreIva)
	fLancaZBol(1600, cFLogo, cFLogo2, cFLogo3, nCreIva)

	//RS
	nPagoDom	:= 0
	nHraExtra	:= 0
Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fLanca    ³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao das Verbas (Lancamentos) Form. Continuo          ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fLanca()                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fLanca(nConta)   // Impressao dos Lancamentos

	Local cString := Transform(aLanca[nConta,5],cPict2)
	Local nCol := If(aLanca[nConta,1]="P",43,If(aLanca[nConta,1]="D",57,27))

	@ LI,01 PSAY aLanca[nConta,2]
	@ LI,05 PSAY aLanca[nConta,3]
	If aLanca[nConta,1] # "B"        // So Imprime se nao for base
		@ LI,36 PSAY TRANSFORM(aLanca[nConta,4],"999.99")
	Endif
	@ LI,nCol PSAY cString
	Li ++

Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fLancaZBol³ Autor ³ Erika                 ³ Data ³ 19/03/08 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao das Verbas (Lancamentos) Zebrado (Bolivia)       ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fLancaZBol()                                               ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fLancaZBol(nLinB, cFLogo, cFLogo2, cFLogo3, nCreIva)   // Impressao dos Lancamentos

	Local nTermina  := 0
	Local nCont     := 0
	Local nCont1    := 0
	Local nValidos  := 0
	Local dFechPago := RCH->RCH_DTPAGO
	Local cDescRot	:= PosAlias("SRY", cRoteiro, SRA->RA_FILIAL, "RY_DESC")
	Local nLineDesc := 100
	Local nColDesc	:= 100
	Local nTotIngr	:= 0
	Local nTotDesc	:= 0
	Local cTab		:= "U001"
	Local aInfoLegal:= {}
	Private nNroLin := 60
	Private aTabU001:= {}
	//	Local cAliasQry   := GetNextAlias()

	cDescRot := if(cRoteiro=='AGU','     ','')+allTrim(cDescRot)
	oPrint:SayBitmap(nLinB+100,090, cFLogo,3000,2000)//Union01.bmp
	cNomeEmp:= AllTrim(UPPER(FWCompanyName()))	//Nombre de la empresa
	oPrint:Say(nLinB+80,1950-nLineDesc,cNomeEmp,oArial08N)

	fCarrTab ( @aTabU001, cTab, dDataRef, .T.)

	//Se recorre el array para filtrar la sucursal del empleado
	for i:= 1 to Len(aTabU001)
		if(TRIM(aTabU001[i][2]) == TRIM(SRA->RA_FILIAL))
			aInfoLegal:= aTabU001[i]
			exit
		endIf
	next i

	//Aviso("Array",U_zArrToTxt(aInfoLegal,,),{"Ok"})

	cNit := TRIM(aInfoLegal[6])
	oPrint:Say(nLinB+130,1950-nLineDesc,"N.I.T. : " + Alltrim(cNit),oArial08N)

	cNrEmplea := TRIM(aInfoLegal[5])
	oPrint:Say(nLinB+180,1950-nLineDesc,"Nro. Empleador: " + Alltrim(cNrEmplea),oArial08N)

	//         linea de abajo   linea de arriba
	oPrint:Box (nLinB+090, 0870, nLinB+170, 1600) //Recuadro
	oPrint:Say(nLinB+110,0900,"BOLETA DE PAGO - " + UPPER(MesExtenso(Month( STOD(TRIM(cPeriodo) + "01")))) + SPACE(1) + UPPER(cValtoChar(Year( STOD(TRIM(cPeriodo) + "01")))),oArial10N)//"BOLETA DE PAGO"

	oPrint:Box (nLinB+390, 0050, nLinB+310, 0800) //Recuadro
	oPrint:Say(nLinB+270,250, "NOMBRE Y APELLIDO" ,oArial09N)
	oPrint:Say(nLinB+340,150,SRA->RA_NOME,oArial08N)

	oPrint:Box (nLinB+390, 1500, nLinB+310, 2500-nLineDesc) //Recuadro
	oPrint:Say(nLinB+340,1550, "CARGO: " + Alltrim(fDesc("SRJ",SRA->RA_CODFUNC,"RJ_DESC")),oArial08N)

	oPrint:Box (nLinB+470, 1500, nLinB+390, 2500-nLineDesc) //Recuadro
	oPrint:Say(nLinB+420,1550, "SALDO DE VACACIONES: " + cValToChar(saldoVac(SRA->RA_FILIAL, SRA->RA_MAT)),oArial08N)
	oPrint:Box (nLinB+550, 1500, nLinB+470, 2500-nLineDesc) //Recuadro
	oPrint:Say(nLinB+500,1550, "SALDO RC-IVA: " + Alltrim(Transform(nCreIva,"999999.99")),oArial08N)

	cMontEmp := val(RCC->RCC_CONTEU) // numero
	If !Empty(RCC->RCC_CONTEU)
		QRYRCC := "QSRC"

		cQuery := "SELECT TOP 1 (RCC_CONTEU) CONTEU "
		cQuery += "FROM " + RetSqlName("RCC") + " RCC "
		cQuery += "WHERE RCC.D_E_L_E_T_ = ' ' "
		cQuery += "AND RCC_CODIGO = 'S005' "
		cQuery += "ORDER BY R_E_C_N_O_ DESC "

		cQuery := ChangeQuery(cQuery)
		dbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), QRYRCC, .F., .T.)
		dbSelectArea(QRYRCC)
		cMontEmp := (QRYRCC)->CONTEU
		(QRYRCC)->(dbCloseArea())

	Endif

	//	Private nPor := 12.71
	//	Private nVari := 4
	Private nToGan := Mathc(12.71, "+" ,TOTVENC)
	Private nSalMin := Mathc(cMontEmp,"+",4)

	//TotalGanado-(TotalGanado*12.71%)-(SalarioMínimoNacional * 4)
	//cMonFac := Negativo(TOTVENC - ( TOTVENC + nPor) - ( cMontEmp + nVari ))

	Private nRest := Mathc(TOTVENC ,"-", nToGan) //resta Total Ganado ,Salario Minimo
	Private cMonFac := Negativo(Mathc(nRest,"-",nSalMin))
	Private nMonFac := 0

	if cMonFac == .F.
		cMonFac := 0
	endif

	oPrint:Box (nLinB+630, 1500, nLinB+550, 2500-nLineDesc) //Recuadro
	// ODR: Mover esta línea despues del total ganado
	//oPrint:Say(nLinB+580,1550,"MONTO APROXIMADO FACTURAS AL 100%: " + TRANS(cMonFac,cPict1),oArial08N)

	cFecAdmi := DTOC(SRA->RA_ADMISSA)
	cSalariB := SRA->RA_SALARIO
	/*
	If !Empty(SRA->RA_UADMANT)   //Carlos
	QRYSR9 := "QSR9"
	//RS
	cQuery := "SELECT * FROM " + RetSqlName("SR9") + " WHERE R_E_C_N_O_ IN ( "
	cQuery += "IsNull((SELECT MAX(R_E_C_N_O_) FROM " + RetSqlName("SR9") + " SR9 "
	cQuery += "WHERE SR9.D_E_L_E_T_ = ' ' AND R9_CAMPO = 'RA_ADMISSA' AND R9_MAT = '" + SRA->RA_MAT + "'"
	cQuery += "AND SUBSTRING(R9_DESC,7,4)+SUBSTRING(R9_DESC,4,2) <= '" + cPeriodo + "' ), "
	cQuery += "(SELECT MIN(R_E_C_N_O_) FROM " + RetSqlName("SR9") + " SR9 "
	cQuery += "WHERE SR9.D_E_L_E_T_ = ' ' AND R9_CAMPO = 'RA_ADMISSA' AND R9_MAT = '" + SRA->RA_MAT + "')))"

	cQuery := ChangeQuery(cQuery)
	dbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), QRYSR9, .F., .T.)
	dbSelectArea(QRYSR9)
	cFecAdmi := if(!Empty((QRYSR9)->R9_DESC),(QRYSR9)->R9_DESC,cFecAdmi)
	(QRYSR9)->( dbCloseArea() )

	QRYSR9 := "QSR9"
	//RS
	cQuery := "SELECT * FROM " + RetSqlName("SR3") + " WHERE R_E_C_N_O_ IN ( "
	cQuery += "SELECT MAX(R_E_C_N_O_) FROM " + RetSqlName("SR3")+ " SR3 "
	cQuery += "WHERE SR3.D_E_L_E_T_ = ' ' AND R3_MAT = '" + SRA->RA_MAT
	cQuery += "' AND SUBSTRING(R3_DATA,1,6) <= '" + cPeriodo + "' )"
	cQuery := ChangeQuery(cQuery)
	dbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), QRYSR9, .F., .T.)
	dbSelectArea(QRYSR9)
	cSalariB := if(!Empty((QRYSR9)->R3_VALOR),(QRYSR9)->R3_VALOR,cSalariB)
	(QRYSR9)->( dbCloseArea() )

	Endif*/
	//X   ,Inicio           ,Fin,Y
	oPrint:SayBitmap(nLinB+703,053, cFLogo2,2445-nLineDesc,074)	//Fondo Gris 1
	oPrint:SayBitmap(nLinB+1392-nLineDesc,053, cFLogo2,2445-nLineDesc,075)	//Fondo Gris 2

	oPrint:Box (nLinB+550,0050, nLinB+470, 0300) //Recuadro
	oPrint:Say(nLinB+430,90, "FECHA ING." ,oArial09N)
	oPrint:Say(nLinB+500,100,cFecAdmi,oArial08N)

	oPrint:Box (nLinB+550,0600, nLinB+470, 0350) //Recuadro
	oPrint:Say(nLinB+430,360, "HABER BASICO" ,oArial09N)
	oPrint:Say(nLinB+500,415,Alltrim(Transform(cSalariB,"999999.99")),oArial08N)

	oPrint:Box (nLinB+550,0650, nLinB+470, 0900) //Recuadro
	oPrint:Say(nLinB+430,730, "C.I.",oArial09N)
	cCarnet := TRIM(SRA->RA_RG) + IIF(!EMPTY(SRA->RA_ALFANUM), "-" + TRIM(SRA->RA_ALFANUM), "") + " " + TRIM(SRA->RA_UFCI)
	oPrint:Say(nLinB+500,675,cCarnet,oArial08N)
	oPrint:Say(nLinB+630,050, "EXPRESADO EN Bs." ,oArial09N)

	/*INGRESOS-DESCUENTOS*/
	oPrint:Box (nLinB+780,0050, nLinB+700, 2500-nLineDesc) //Recuadro
	oPrint:Line(nLinB+700, 1220, nLinB+1470-nLineDesc, 1220) //Linea Vertical
	oPrint:Say(nLinB+727,500, STR0129, oArial10N)  //" I N G R E S O S "
	oPrint:Say(nLinB+727,1680, STR0028, oArial10N) //" D E S C U E N T O S"

	oPrint:Say(nLinB+800,130, "CONCEPTOS", oArial10N)
	oPrint:Say(nLinB+800,1300, "CONCEPTOS", oArial10N)
	oPrint:Say(nLinB+800,890, "REF.", oArial10N)
	oPrint:Say(nLinB+800,2140-nLineDesc, "REF.", oArial10N)
	oPrint:Say(nLinB+800,1030, "IMPORTE", oArial10N)
	oPrint:Say(nLinB+800,2290-nLineDesc, "IMPORTE", oArial10N)
	//         linea de abajo   linea de arriba
	/*CONCEPTOS-IMPORTE*/
	oPrint:Box (nLinB+860,0050, nLinB+780, 2500-nLineDesc) //Recuadro
	//         linea de abajo   linea de arriba
	oPrint:Line(nLinB+780, 0840, nLinB+1390-nLineDesc, 0840) //Linea Vertical
	oPrint:Line(nLinB+780, 0990, nLinB+1390-nLineDesc, 0990) //Linea Vertical
	oPrint:Line(nLinB+780, 2100-nLineDesc, nLinB+1390-nLineDesc, 2100-nLineDesc) //Linea Vertical
	oPrint:Line(nLinB+780, 2250-nLineDesc, nLinB+1390-nLineDesc, 2250-nLineDesc) //Linea Vertical
	/*TOTAL GANADO-TOTAL EGRESOS*/
	oPrint:Box (nLinB+1390-nLineDesc,0050, nLinB+800-nLineDesc, 2500-nLineDesc) //Recuadro
	/*LIQUIDO PAGABLE*/
	oPrint:Box (nLinB+1570-nLineDesc,0670, nLinB+1500-nLineDesc, 1220) //Recuadro
	oPrint:Line(nLinB+1570-nLineDesc,0970, nLinB+1500-nLineDesc, 0970) //Linea Vertical

	//nTermina := Max(Max(LEN(aProve),LEN(aDesco)),LEN(aBases))
	nTermina := 12

	//	For i := 1 to len(aDesco)
	//		for z := 1 to len(aDesco[i])
	//			alert(aDesco[i,z])
	//		next z
	//	next i
	nLineaIngr:= 820+50
	nLineaDesc:= 820+50
	For nCont := 1 To nTermina
		nColsB:= 820+(50*nCont)
		IF nCont <= LEN(aProve) // IMPRIMR

			/*Obtiene el Concepto*/
			cCodConc := SubStr((aProve[nCont,1]),1,3)
			nAgrupa := posicione("SRV",1,xFilial("SRV") + cCodConc , "RV_UAGRBOL") // Agrupado o No Agrupado
			/*Si esta vacio el campo RV_UAGRBOL le coloca 2*/
			if nAgrupa == Nil
				nAgrupa := 2
			endif
			/*Si es diferente de 1 Imprime Normal*/
			if nAgrupa != '1' .OR. cCodConc == cIngrPD
				oPrint:Say(nLinB+nLineaIngr,50, "   " + aProve[nCont,1],oArial08)  //Detalle Ingresos
				oPrint:Say(nLinB+nLineaIngr,860, TRANSFORM(aProve[nCont,2],'999.99'),oArial08) //Detalle Ingresos
				oPrint:Say(nLinB+nLineaIngr,1015, TRANSFORM(aProve[nCont,3], cPict3),oArial08) //Detalle Ingresos
				nLineaIngr+=50
				nTotIngr+= aProve[nCont,3]
			endif
		ENDIF

		IF nCont <= LEN(aDesco)
			/*Obtiene el Concepto*/
			cCodCop := SubStr((aDesco[nCont,1]),1,3)
			nGroup := posicione("SRV",1,xFilial("SRV") + cCodCop , "RV_UAGRBOL") // Agrupado o No Agrupado
			/*Si esta vacio el campo RV_UAGRBOL le coloca 2*/
			if nGroup == Nil
				nGroup := 2
			endif
			/*Si es diferente de 1 Imprime Normal*/
			if nGroup != '1' .OR. cCodCop == cDescPd
				oPrint:Say(nLinB+nLineaDesc,1215, "   " + aDesco[nCont,1],oArial08)
				oPrint:Say(nLinB+nLineaDesc,2120-nLineDesc, TRANSFORM(aDesco[nCont,2],'999.99'))
				oPrint:Say(nLinB+nLineaDesc,2280-nLineDesc, TRANSFORM(aDesco[nCont,3],cPict3))
				nLineaDesc+=50
				nTotDesc+= aDesco[nCont,3]
			endif

		ENDIF

		//---- Soma 1 nos nValidos e Linha
		nValidos ++
		//	Li ++

		If nValidos == 12

			oPrint:Box (nLinB+1470-nLineDesc,0050, nLinB+1390-nLineDesc, 2500-nLineDesc) //Recuadro
			oPrint:Say(nLinB+nColsB+0-nLineDesc,090, "TOTAL GANADO",oArial08N) //"| TOTAL INGRESOS" + SPACE(10)
			//oPrint:Say(nLinB+nColsB+0-nLineDesc,950, TRANS(TOTVENC, cPict1))
			oPrint:Say(nLinB+nColsB+0-nLineDesc,950, TRANS(nTotIngr, cPict1))
			oPrint:Say(nLinB+nColsB+0-nLineDesc,1280, STR0126 + SPACE(10),oArial08N) //" TOTAL EGRESOS"
			//oPrint:Say(nLinB+nColsB+0-nLineDesc,2220-nLineDesc, TRANS(TOTDESC, cPict1))
			oPrint:Say(nLinB+nColsB+0-nLineDesc,2220-nLineDesc, TRANS(nTotDesc, cPict1))
			oPrint:Say(nLinB+nColsB+150-nLineDesc,25, DESC_MSG1)
			//oPrint:Say(nLinB+nColsB+100-nLineDesc,0700, "LIQUIDO PAGABLE" + SPACE(1) + TRANS((TOTVENC-TOTDESC),cPict1)) //"LIQUIDO PAGABLE: "
			oPrint:Say(nLinB+nColsB+100-nLineDesc,0700, "LIQUIDO PAGABLE" + SPACE(1) + TRANS((nTotIngr-nTotDesc),cPict1)) //"LIQUIDO PAGABLE: "

			//oPrint:SayBitmap(nLinB+100,090, cFLogo,3000,2000)//Union01.bmp

			//oPrint:Say(nLinB+nColsB+200,25, DESC_MSG2)
			//oPrint:Say(nLinB+nColsB+250,25, DESC_MSG3)
			oPrint:Say(nLinB+nColsB+160-nLineDesc,0070, REPLICATE("_",140))
			oPrint:Say(nLinB+nColsB+230-nLineDesc,900,"SANTA CRUZ, " + cValtoChar(Day(dDataBase)) + STR0080 + MesExtenso(Month(dDataBase)) + STR0080 + cValtoChar(Year(dDataBase)) + ".")
			oPrint:Say(nLinB+nColsB+210-nLineDesc,1830, "RECIBI CONFORME",oArial08N)
			oPrint:Say(nLinB+nColsB+210-nLineDesc,0300, "VoBo",oArial08N)

		Endif

	Next nCont

	aArea:= GetArea()
	QRYRCC := "QRCC"
	cQuery := "SELECT CASE "
	cQuery += " WHEN A.CONTEU IS NOT NULL "
	cQuery += " THEN A.CONTEU "
	cQuery += " ELSE B.CONTEU "
	cQuery += " END AS CONTEU "
	cQuery += " FROM "
	cQuery += " (SELECT TOP 1 MAX(RCC_CONTEU) CONTEU FROM " + RetSqlName("RCC")
	cQuery += " WHERE RCC_CODIGO = 'S005' AND D_E_L_E_T_ = '' AND RCC_CHAVE >= '" + cPeriodo + "') A, "
	cQuery += " (SELECT TOP 1 (RCC_CONTEU) CONTEU FROM " + RetSqlName("RCC")
	cQuery += " WHERE RCC_CODIGO = 'S005' AND D_E_L_E_T_ = '' AND RCC_CHAVE = '') B "
	cQuery := ChangeQuery(cQuery)
	dbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), QRYRCC, .F., .T.)
	dbSelectArea(QRYRCC)
	cMontEmp := 0
	IF (QRYRCC)->(!EOF())
		cMontEmp := (QRYRCC)->CONTEU
	ENDIF
	(QRYRCC)->(dbCloseArea())
	RestArea(aArea)

	//ALERT(CVALTOCHAR(nTotIngr) + " - " + cMontEmp + " - " + CVALTOCHAR(nCreIva))
	nMonFac := nTotIngr - (4*VAL(cMontEmp)) - (nCreIva/0.13)
	IF nMonFac < 0
		nMonFac := 0
	ENDIF
	oPrint:Say(nLinB+580,1550,"MONTO APROXIMADO FACTURAS AL 100%: " + TRANS(nMonFac,cPict4),oArial08N)

Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fContinua ³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressap da Continuacao do Recibo                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fContinua()                                                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fContinua()    // Continuacao do Recibo

	Li+=1
	@ LI,05 PSAY &cNormal + STR0037		//"CONTINUA !!!"
	Li+= 7 //8

Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fRodape   ³ Autor ³ R.H. - Ze Maria       ³ Data ³ 14.03.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Impressao do Rodape                                        ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fRodape()                                                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico                                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fRodape(lLinhaRoda)    // Rodape do Recibo //CARLOS

	If !lLinhaRoda
		LI += 1
	Endif
	@ LI,05 PSAY DESC_MSG1
	LI ++
	@ LI,05 PSAY DESC_MSG2
	@ LI,42 PSAY TOTVENC PICTURE cPict1
	@ LI,56 PSAY TOTDESC PICTURE cPict1
	LI ++
	@ LI,05 PSAY DESC_MSG3
	LI ++
	IF MONTH(dDataRef) = MONTH(SRA->RA_NASC)
		@ LI, 02 PSAY STR0038		//"F E L I Z   A N I V E R S A R I O  ! !"
	ENDIF
	@ LI,56 PSAY TOTVENC - TOTDESC PICTURE cPict1
	LI +=2

	nValSal := 0
	nValSal := fBuscaSal(dDataRef)
	If nValSal ==0
		nValSal := SRA->RA_SALARIO
	EndIf

	@ LI,05 PSAY &cCompac+Transform(nValSal,cPict2)

	If cTipoRot = "2"  // Bases de Adiantamento
		If cBaseAux = "S" .And. nBaseIr # 0
			@ LI,89 PSAY nBaseIr PICTURE cPict1
		Endif
	ElseIf cTipoRot = "1" .Or. cTipoRot = "6"  // Bases de Folha e 13o. 2o.Parc.
		If cBaseAux = "S"
			@ LI,23 PSAY Transform(nAteLim,cPict1)
			If nBaseFgts # 0
				@ LI,46 PSAY nBaseFgts PICTURE cPict1
			Endif
			If nFgts # 0
				@ LI,66 PSAY nFgts PICTURE cPict2
			Endif
			If nBaseIr # 0
				@ LI,89 PSAY nBaseIr PICTURE cPict1
			Endif
			@ LI,103 PSAY Transform(nBaseIrfE,cPict1)
		Endif
	ElseIf cTipoRot = "5" // Bases de FGTS e FGTS Depositado da 1¦ Parcela
		If cBaseAux = "S"
			If nBaseFgts # 0
				@ LI,46 PSAY nBaseFgts PICTURE cPict1
			Endif
			If nFgts # 0
				@ LI,66 PSAY nFgts PICTURE cPict2
			Endif
		Endif
	Endif

	@ LI,Pcol() Psay &cNormal

	Li ++
	IF SRA->RA_BCDEPSAL # SPACE(8)
		Desc_Bco := DescBco(Sra->Ra_BcDepSal,Sra->Ra_Filial)
		@ LI,01 PSAY STR0039	//"CRED:"
		@ LI,06 PSAY SRA->RA_BCDEPSAL
		@ LI,14 PSAY "-"
		@ LI,15 PSAY DESC_BCO
		@ LI,50 PSAY STR0040 + SRA->RA_CTDEPSAL	//"CONTA:"
	ENDIF
	LI += 2
	@ LI,05 PSAY " "
Return Nil

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fSomaPdRec³ Autor ³ R.H. - Mauro          ³ Data ³ 24.09.95 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Somar as Verbas no Array                                   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ fSomaPdRec(Tipo,Verba,Horas,Valor)                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
User Function fSomaPdRec(cTipo,cPd,nHoras,nValor)  //CARLOS
	Local Desc_paga

	Static lAglutPd // Sera utilizada em todas as chamadas da funcao fSomaPdRec()

	If lAglutPd == Nil
		lAglutPd := ( GetMv("MV_AGLUTPD",,"1") == "1" ) // 1-Aglutina verbas   2-Nao Aglutina
	EndIf

	Desc_paga := DescPd(cPd,Sra->Ra_Filial)  // mostra como pagto

	If cTipo # 'B'
		//--Array para Recibo Pre-Impresso
		nPos := Ascan(aLanca,{ |X| X[2] = cPd })
		If nPos == 0 .Or. !lAglutPd
			Aadd(aLanca,{cTipo,cPd,Desc_Paga,nHoras,nValor})
		Else
			aLanca[nPos,4] += nHoras
			aLanca[nPos,5] += nValor
		Endif
	Endif

	//--Array para o Recibo Pre-Impresso
	If cTipo = 'P'
		cArray := "aProve"
	Elseif cTipo = 'D'
		cArray := "aDesco"
	Elseif cTipo = 'B'
		cArray := "aBases"
	Endif

	nPos := Ascan(&cArray,{ |X| X[1] = cPd })
	If nPos == 0 .Or. !lAglutPd
		If cPd == fGetCodFol("0066")// .And. .F.
			nIvaF := GetAdvFVal("SRR","RR_VALOR",XFILIAL("SRR")+SRA->RA_MAT+cPeriodo+"FIN01"+fGetCodFol("0066"),4,"")
			If !Empty(nIvaF)
				nValor := nValor-nIvaF
				Aadd(&cArray,{cPd+" "+AllTrim(Desc_Paga)+"-FIN",nHoras,nIvaF })
			EndIf
		EndIf
		Aadd(&cArray,{cPd+" "+Desc_Paga,nHoras,nValor })
	Else
		&cArray[nPos,2] += nHoras
		&cArray[nPos,3] += nValor
	Endif
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³fSendDPgto| Autor ³ R.H.-Natie            ³ Data ³ 15.08.01 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Envio de E-mail -Demonstrativo de Pagamento                ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³                                                            ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Especifico :Envio Demonstrativo de Pagto atraves de eMail  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³         ATUALIZACOES SOFRIDAS DESDE A CONSTRU€AO INICIAL.             ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Programador ³ Data   ³ BOPS ³  Motivo da Alteracao                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³            ³        ³      ³                                          ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function fSendDPgto(lTerminal)
	Local aSvArea		:= GetArea()
	Local aGetArea		:= {}
	Local cEmail		:= If(SRA->RA_RECMAIL=="S",SRA->RA_EMAIL,"    ")
	Local cHtml			:= ""
	Local cSubject		:= STR0044	//" DEMONSTRATIVO DE PAGAMENTO "
	Local cMesComp		:= IF( Month(dDataRef) + 1 > 12 , 01 , Month(dDataRef) )
	Local cTipo			:= ""
	Local cReferencia	:= ""
	Local cVerbaLiq		:= ""
	Local dDataPagto	:= Ctod("//")
	Local nZebrado		:= 0.00
	Local nResto		:= 0.00
	Local nProv
	Local nDesco
	Local cCodFunc		:= ""		//-- codigo da Funcao do funcionario
	Local cDescFunc		:= ""		//-- Descricao da Funcao do Funcionario
	Local cDescUbigeo    := ""

	Private cMailConta	:= NIL
	Private cMailServer	:= NIL
	Private cMailSenha	:= NIL

	lTerminal := IF( lTerminal == NIL .or. ValType( lTerminal ) != "L" , .F. , lTerminal )

	aGetArea	:= SRC->( GetArea() )
	cTipo		:= PosAlias("SRY", cRoteiro, SRA->RA_FILIAL, "RY_DESC")

	IF cTipoRot == "2"
		cVerbaLiq	:= PosSrv( "007ADT" , xFilial("SRA") , "RV_COD" , RetOrdem("SRV","RV_FILIAL+RV_CODFOL") , .F. )
	ElseIF cTipoRot == "1"
		cVerbaLiq	:= PosSrv( "047CAL" , xFilial("SRA") , "RV_COD" , RetOrdem("SRV","RV_FILIAL+RV_CODFOL") , .F. )
	ElseIF cTipoRot == "5"
		cVerbaLiq	:= PosSrv( "022C13" , xFilial("SRA") , "RV_COD" , RetOrdem("SRV","RV_FILIAL+RV_CODFOL") , .F. )
	ElseIF cTipoRot == "6"
		cVerbaLiq	:= PosSrv( "021C13" , xFilial("SRA") , "RV_COD" , RetOrdem("SRV","RV_FILIAL+RV_CODFOL") , .F. )
	ElseIF  cRoteiro == "EXT"
		cTipo		:= STR0064 //"Valores Extras"
		cVerbaLiq	:= ""
	EndIF

	IF  cRoteiro <> "EXT"
		DbSelectArea( "RCH" )
		DbSetOrder( 1 )
		DbSeek( xFilial( "RCH" ) + cProcesso + cPeriodo + Semana + cRoteiro, .F. )
		If Eof()
			DbSeek( xFilial( "RCH" ) + cProcesso + cPeriodo + Semana + Space(GetSx3Cache( "RCH_ROTEIR", "X3_TAMANHO" )), .F. )
		EndIf
		If !Eof()
			dDataPagto := RCH->RCH_DTPAGO
		Else
			Help( " ", 1, "REGNOIS" )
		EndIf
	EndIf

	IF !( lTerminal )

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Busca parametros                                             ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		cMailConta	:=If(cMailConta == NIL,GETMV("MV_EMCONTA"),cMailConta)             //Conta utilizada p/envio do email
		cMailServer	:=If(cMailServer == NIL,GETMV("MV_RELSERV"),cMailServer)           //Server
		cMailSenha	:=If(cMailSenha == NIL,GETMV("MV_EMSENHA"),cMailSenha)

		If Empty(cEmail)
			Return
		Endif

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Verifica se existe o SMTP Server                             ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If 	Empty(cMailServer)
			Help(" ",1,"SEMSMTP")//"O Servidor de SMTP nao foi configurado !!!" ,"Atencao"
			Return(.F.)
		EndIf

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Verifica se existe a CONTA                                   ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If 	Empty(cMailConta)
			Help(" ",1,"SEMCONTA")//"A Conta do email nao foi configurado !!!" ,"Atencao"
			Return(.F.)
		EndIf

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Verifica se existe a Senha                                   ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		If 	Empty(cMailServer)
			Help(" ",1,"SEMSENHA")	//"A Senha do email nao foi configurado !!!" ,"Atencao"
			Return(.F.)
		EndIf

	EndIF

	cReferencia	:= AllTrim( MesExtenso(Month(dDataRef))+"/"+STR(YEAR(dDataRef),4) ) + " - ( " + cTipo + "-" + cPeriodo + "/" + Semana + " )"

	cHtml +=	'<html>'
	cHtml +=		'<head>'
	IF !( lTerminal )

		cHtml += 		'<title>DEMONSTRATIVO DE PAGAMENTO</title>'
		cHtml +=			'<style>'
		cHtml +=				'th { text-align:left; background-color:#4B87C2; line-height:01; line-width:400; border-left:0px solid  #FF9B06; border-right:0px solid #FF9B06; border-bottom:0px solid #FF9B06 ; border-top:0px solid #FF9B06 }'
		cHtml +=				'.tdPrinc { text-align:left; line-height:1; line-width:340 ; border-left:0px solid #FF9B06; border-right:0px solid #FF9B06; border-bottom:0px solid #FF9B06 ; border-top:0px solid #FF9B06 > }'
		cHtml +=				'.td18_94_AlignR { text-align:right ; line-height:1; line-width:94 }'
		cHtml +=				'.td18_95_AlignR { text-align:right ; line-height:1; line-width:95 }'
		cHtml +=				'.td26_94_AlignR { text-align:right ; line-height:1; line-width:94 }'
		cHtml +=				'.td26_95_AlignR { text-align:right ; line-height:1; line-width:95 }'
		cHtml += 				'.td26_18_AlignL { lext-align:left ; line-height:1; line:width:18 ; border-left:0px solid #FF9B06; border-right:0px solid #FF9B06; border-bottom:0px solid #FF9B06 ; border-top:0px solid #FF9B06 bgcolor=#6F9ECE" }'
		cHtml +=    			'.pStyle1 { line-height:100% ; margin-top:15 ; margin-bottom:0 }'
		cHtml +=			'</style>'
		cHtml +=	'</head>'
		cHtml +=		'<body bgcolor="#FFFFFF"  topmargin="0" leftmargin="0">'
		cHtml +=			'<center>'
		cHtml +=				'<table  border="1" cellpadding="0" cellspacing="0" bordercolor="#FF9B06" bgcolor="#000082" width=598 height="637">'
		cHtml +=    				'<td width="598" height="181" bgcolor="FFFFFF">'
		cHtml += 					'<center>'
		cHtml += 					'<font color="#000000">'
		cHtml +=					'<b>'
		cHtml += 					'<h4 size="03">'
		cHtml +=					'<br>'
		cHtml += 						STR0044 // " DEMONSTRATIVO DE PAGAMENTO "
		cHtml += 					'<br>'

	Else

		cHtml += 		'<title>RH Online</title>' + CRLF
		cHtml += 		'<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">' + CRLF
		cHtml += 		'<link rel="stylesheet" href="css/rhonline.css" type="text/css">' + CRLF
		cHtml += 	'</head>' + CRLF
		cHtml += 	'<body bgcolor="#FFFFFF" text="#000000">' + CRLF
		cHtml += 		'<Table width="515" border="0" cellspacing="0" cellpadding="0">' + CRLF

		//Cabecalho
		cHtml += 			CabecHtml( cReferencia , dDataPagto , dDataRef )

		//Separador
		cHtml +=			"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=				"<TBODY>" + CRLF
		cHtml +=					"<TR>" + CRLF
		cHtml +=						"<TD vAlign=top width='100%' height=10>" + CRLF
		cHtml +=						"</TD>" + CRLF
		cHtml +=	 				"</TR>" + CRLF
		cHtml +=				"</TBODY>" + CRLF
		cHtml +=			"</TABLE>" + CRLF

		cHtml +=			"<TABLE border='1' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=				"<TBODY>" + CRLF
	EndIF

	If !Empty(Semana) .And. Semana # "99" .And.  Upper(SRA->RA_TIPOPGT) == "S"
		IF !( lTerminal )
			cHtml += cReferencia
		EndIF
	Else
		IF !( lTerminal )
			cHtml += cReferencia
		EndIF
	EndIf

	/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Carrega Funcao do Funcion. de acordo com a Dt Referencia     ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	fBuscaFunc(dDataRef, @cCodFunc, @cDescFunc   )

	IF !( lTerminal )

		If cPaisloc <> "PER"
			cHtml += '</b></h4></font></center>'
			cHtml += '<hr whidth = 100% align=right color="#FF812D">'
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Dados do funcionario                                         ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			cHtml += '<!Dados do Funcionario>'
			cHtml += '<p align=left  style="margin-top: 0">'
			cHtml +=   '<font color="#000082" face="Courier New"><i><b>'
			cHtml +=  	'&nbsp;&nbsp;&nbsp' + SRA->RA_NOME + "-" + SRA->RA_MAT+'</i><br>'
			cHtml += 	'&nbsp;&nbsp;&nbsp' + STR0048 + cCodFunc + "  "+cDescFunc	+'<br>' //"Funcao    - "
			cHtml +=  	'&nbsp;&nbsp;&nbsp' + STR0047 + SRA->RA_CC + " - " + DescCc(SRA->RA_CC,SRA->RA_FILIAL) +'<br>' //"C.Custo   - "
			cHtml +=    '&nbsp;&nbsp;&nbsp' + STR0049 + SRA->RA_BCDEPSAL+"-"+DescBco(SRA->RA_BCDEPSAL,SRA->RA_FILIAL)+ '&nbsp;'+  SRA->RA_CTDEPSAL //"Bco/Conta - "
			cHtml += '</b></p></font>'
			cHtml += '<!Proventos e Desconto>'
			cHtml += '<div align="center">'
			cHtml += '<Center>'
			cHtml += '<Table bgcolor="#6F9ECE" border="0" cellpadding ="1" cellspacing="0" width="553" height="296">'
			cHtml += '<TBody><Tr>'
			cHtml +=	'<font face="Arial" size="02" color="#000082"><b>'
			cHtml += 	'<th>' + STR0050 + '</th>' //"Cod  Descricao "
			cHtml += 	'<th>' + STR0051 + '</th>' //"Referencia"
			cHtml += 	'<th>' + STR0052 + '</th>' //"Valores"
			cHtml += 	'</b></font></tr>'
			cHtml += '<font color=#000082 face="Courier new"  size=2">'
		ELSE //Cabecalho utilizado pela localizacao Peru
			cHtml += '</b></h4></font></center>'
			cHtml += '<hr whidth = 100% align=right color="#FF812D">'
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Dados do funcionario                                         ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			cHtml += '<!Dados do Funcionario>'
			cHtml += '<p align=left  style="margin-top: 0">'
			cHtml +=   '<font color="#000082" face="Courier New"><i><b>'
			cHtml +=  	'&nbsp;&nbsp' + STR0001 + ":" + '&nbsp;' + SRA->RA_MAT + '&nbsp;' + "-" + '&nbsp;' + SRA->RA_NOME +'</i><br>' //Funcionario
			cHtml += 	'&nbsp;&nbsp' + "DNI" + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + ":"   +  '&nbsp;' + SRA->RA_RG      + '&nbsp;&nbsp;' + STR0174 + '&nbsp;' +":"+ '&nbsp;' + AllTrim(STR(SRA->RA_HRSMES))+'<br>' //"DNI + Horas Mensais
			cHtml += 	'&nbsp;&nbsp' + "AFP" + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + ":"   +  Space(1) + SRA->RA_CODAFP  + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + "Ubigeo :" + '&nbsp;' + cDescUbigeo +'<br>' //"DNI + Horas Mensais
			cHtml += 	'&nbsp;&nbsp' + STR0103 + '&nbsp;&nbsp;' + ":" + '&nbsp;' + cCodFunc   + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + STR0069 + '&nbsp;' + ":" + '&nbsp;' + cDescFunc	+'<br>' //"Funcao    - Descricao "
			cHtml +=  	'&nbsp;&nbsp' + STR0002 + '&nbsp;&nbsp'  + ":" + '&nbsp;' + SRA->RA_CC + '&nbsp;'+ "-" + '&nbsp;' + DescCc(SRA->RA_CC,SRA->RA_FILIAL) +'<br>' //"C.Custo   - "
			cHtml +=    '&nbsp;&nbsp' + STR0049 + SRA->RA_BCDEPSAL+"-"+DescBco(SRA->RA_BCDEPSAL,SRA->RA_FILIAL)+ '&nbsp;'+  SRA->RA_CTDEPSAL //"Bco/Conta - "
			cHtml += '</b></p></font>'
			cHtml += '<!Proventos e Desconto>'
			cHtml += '<div align="center">'
			cHtml += '<Center>'
			cHtml += '<Table bgcolor="#6F9ECE" border="0" cellpadding ="1" cellspacing="0" width="553" height="296">'
			cHtml += '<TBody><Tr>'
			cHtml +=	'<font face="Arial" size="02" color="#000082"><b>'
			cHtml += 	'<th>' + STR0050 + '</th>' //"Cod  Descricao "
			cHtml += 	'<th>' + STR0051 + '</th>' //"Referencia"
			cHtml += 	'<th>' + STR0052 + '</th>' //"Valores"
			cHtml += 	'</b></font></tr>'
			cHtml += '<font color=#000082 face="Courier new"  size=2">'
		ENDIF

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Espacos Entre os Cabecalho e os Proventos/Descontos          ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		cHtml += 	'<tr>'
		cHtml += 		'<td class="tdPrinc"></td>'
		cHtml += 		'<td class="td18_94_AlignR">&nbsp;&nbsp</td>'
		cHtml += 		'<td class="td18_95_AlignR">&nbsp;&nbsp</td>'
		cHtml += 		'<td class="td18_18_AlignL"></td>'
		cHtml += 	'</tr>'

	Else

		//Cabecalho dos valores
		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml += 							'<tr align="center">' + CRLF
		cHtml += 								'<td width="45" height="1">' + CRLF
		cHtml += 									'<span class="etiquetas"><div align="Left">'+ STR0068 + '</span></div>' + CRLF //C&oacute;digo
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="219" valign="top">' + CRLF
		cHtml += 									'<span class="etiquetas"><div align="left">' + STR0069 + '</span></div>' + CRLF //Descri&ccedil;&atilde;o
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top">' + CRLF
		cHtml += 									'<span class="etiquetas"><div align="right">' + STR0070  + '</span></div>' + CRLF //Refer&ecirc;ncia
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top">' + CRLF
		cHtml += 									'<span class="etiquetas"><div align="right">' + STR0052 + '</span></div>' + CRLF //Valores
		cHtml += 								'<td width="107" valign="top">' + CRLF
		cHtml += 									'<span class="etiquetas"><div align="right"> (+/-) </span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 							'</tr>' + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml += 					'</TABLE>' + CRLF

		//Separador
		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml +=							"<TR>" + CRLF
		cHtml +=								"<TD vAlign=top width='100%' height=05>" + CRLF
		cHtml +=								"</TD>" + CRLF
		cHtml +=	 						"</TR>" + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml +=					"</TABLE>" + CRLF

		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml +=							"<TR>" + CRLF

	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Proventos                                                    ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	For nProv:=1 To Len( aProve )

		nResto := ( ++nZebrado % 2 )

		IF !( lTerminal )

			cHtml += '<tr>'
			cHtml += 	'<td class="tdPrinc">' + aProve[nProv,1] + '</td>'
			cHtml += 	'<td class="td18_94_AlignR">' + Transform(aProve[nProv,2],'999.99')+'</td>'
			cHtml += 	'<td class="td18_95_AlignR">' + Transform(aProve[nProv,3],cPict3) + '</td>'
			cHtml +=    '<td class="td18_18_AlignL"></td>'
			cHtml += '</tr>'

		Else

			cHtml += 							'<tr>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="45" vAlign=top height="1" bgcolor="#FAFBFC">'
			Else
				cHtml += 							'<td width="45" vAlign=top height="1">' + CRLF
			EndIF
			cHtml += 									'<div align="left"><span class="dados">'  + Substr( aProve[nProv,1] , 1 , 3 ) + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="219" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="219" vAlign=top="top">' + CRLF
			EndIF
			cHtml += 									'<div align="Left"><span class="dados">'  + Capital( AllTrim( Substr( aProve[nProv,1] , 4 ) ) ) + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="127" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="right"><span class="dados">' + Transform(aProve[nProv,2],'999.99') + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="127" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="right"><span class="dados">' + Transform(aProve[nProv,3],cPict3) + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="107" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="107" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="right"><span class="dados"> (+) </span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			cHtml += 							'</tr>' + CRLF
		EndIF
	Next nProv

	IF ( lTerminal )
		cHtml +=							"</TR>" + CRLF
		cHtml +=							"<TR>" + CRLF
	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Descontos                                                    ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	For nDesco := 1 to Len(aDesco)

		nResto := ( ++nZebrado % 2 )

		IF !( lTerminal )

			cHtml += '<tr>'
			cHtml += 	'<td class="tdPrinc">' + aDesco[nDesco,1] + '</td>'
			cHtml += 	'<td class="td18_94_AlignR">' + Transform(aDesco[nDesco,2],'999.99') + '</td>'
			cHtml += 	'<td class="td18_95_AlignR">' + Transform(aDesco[nDesco,3],cPict3) + '</td>'
			cHtml += 	'<td class="td18_18_AlignL">-</td>'
			cHtml += '</tr>'

		Else

			cHtml += 							'<tr>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="45" align="center" height="19" bgcolor="#FAFBFC">'
			Else
				cHtml += 							'<td width="45" align="center" height="19">' + CRLF
			EndIF
			cHtml += 									'<div align="left"><span class="dados">'  + Substr( aDesco[nDesco,1] , 1 , 3 ) + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="219" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="219" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="Left"><span class="dados">'  + Capital( AllTrim( Substr( aDesco[nDesco,1] , 4 ) ) ) + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="127" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="right"><span class="dados">' + Transform(aDesco[nDesco,2],'999.99') + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="127" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="right"><span class="dados">' + Transform(aDesco[nDesco,3],cPict3) + '</span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			IF nResto > 0.00
				cHtml += 							'<td width="107" valign="top" bgcolor="#FAFBFC">' + CRLF
			Else
				cHtml += 							'<td width="107" valign="top">' + CRLF
			EndIF
			cHtml += 									'<div align="right"><span class="dados"> (-) </span></div>' + CRLF
			cHtml += 								'</td>' + CRLF
			cHtml += 							'</tr>' + CRLF
		EndIF
	Next nDesco

	IF ( lTerminal )

		cHtml +=							"</TR>" + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml +=					"</TABLE>" + CRLF

		//Separador
		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml +=							"<TR>" + CRLF
		cHtml +=								"<TD vAlign=top width='100%' height=05>" + CRLF
		cHtml +=								"</TD>" + CRLF
		cHtml +=	 						"</TR>" + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml +=					"</TABLE>" + CRLF

		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml +=							"<TR>" + CRLF

	EndIF

	IF !( lTerminal )

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Espacos Entre os Proventos e Descontos e os Totais           ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		cHtml += 	'<tr>'
		cHtml += 		'<td class="tdPrinc"></td>'
		cHtml += 		'<td class="td18_94_AlignR">&nbsp;&nbsp</td>'
		cHtml += 		'<td class="td18_95_AlignR">&nbsp;&nbsp</td>'
		cHtml += 		'<td class="td18_18_AlignL"></td>'
		cHtml += 	'</tr>'

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Totais                                                       ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		cHtml += '<!Totais >'
		cHtml +=	'<b><i>'
		cHtml += 	'<tr>'
		cHtml += 		'<td class="tdPrinc">' + STR0053 + '</td>' //"Total Bruto "
		cHtml += 		'<td class="td18_94_AlignR"></td>'
		cHtml += 		'<td class="td18_95_AlignR">' + Transform(TOTVENC,cPict3) + '</td>'
		cHtml += 		'<td class="td18_18_AlignL"></td>'
		cHtml +=	'</tr>'
		cHtml += 	'<tr>'
		cHtml += 		'<td class="tdPrinc">' + STR0054 + '</td>' //"Total Descontos "
		cHtml += 		'<td class="td18_94_AlignR"></Td>'
		cHtml += 		'<td class="td18_95_AlignR">' + Transform(TOTDESC,cPict3) + '</td>'
		cHtml += 		'<td class="td18_18_AlignL">-</td>'
		cHtml += 	'</tr>'
		cHtml += 	'<tr>'
		cHtml += 		'<td class="tdPrinc">' + STR0055 + '</td>' //"Liquido a Receber "
		cHtml += 		'<td class="td18_94_AlignR"></td>'
		cHtml += 		'<td align=right height="18" width="95" Style="border-left:0px solid #FF812D; border-right:0px solid #FF9B06; border-bottom:0px solid #FF9B06 ; border-top:1px solid #FF9B06 bgcolor=#4B87C2">'
		cHtml +=        Transform((TOTVENC-TOTDESC),cPict3) +'</td>'
		cHtml += 	'</tr>'
		cHtml += '<!Bases>'
		cHtml += 	'<tr>'

	Else

		//Total de Proventos
		cHtml += 							'<tr>' + CRLF
		cHtml += 								'<td width="219" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> ' + STR0065 + '</div>' + CRLF //"Total Bruto: "
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="45" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> </div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> </div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="right"><span class="dados">' + Transform(TOTVENC,cPict3) + '</span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="107" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="right"><span class="dados"> (+) </span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 							'</tr>' + CRLF

		//Total de Descontos
		cHtml += 							'<tr>' + CRLF
		cHtml += 								'<td width="219" valign="top">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> ' + STR0066 + '</div>' + CRLF //"Total de Descontos: "
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="45" valign="top">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> </div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> </div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top">' + CRLF
		cHtml += 									'<div align="right"><span class="dados">' + Transform(TOTDESC,cPict3) + '</span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="107" valign="top">' + CRLF
		cHtml += 									'<div align="right"><span class="dados"> (-) </span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 							'</tr>' + CRLF

		//Liquido
		cHtml += 							'<tr>' + CRLF
		cHtml += 								'<td width="219" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas">' + STR0067  + '</div>' + CRLF //"L&iacute;quido a Receber: "
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="45" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> </div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="left" class="etiquetas"> </div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="127" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="right"><span class="dados">' + Transform((TOTVENC-TOTDESC),cPict3) + '</span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 								'<td width="107" valign="top" bgcolor="#FAFBFC">' + CRLF
		cHtml += 									'<div align="right"><span class="dados"> (=) </span></div>' + CRLF
		cHtml += 								'</td>' + CRLF
		cHtml += 							'</tr>' + CRLF

		cHtml +=							"</TR>" + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml +=					"</TABLE>" + CRLF

		//Separador
		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml +=							"<TR>" + CRLF
		cHtml +=								"<TD vAlign=top width='100%' height=10>" + CRLF
		cHtml +=								"</TD>" + CRLF
		cHtml +=	 						"</TR>" + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml +=					"</TABLE>" + CRLF

		cHtml +=					"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=						"<TBODY>" + CRLF
		cHtml +=							"<TR>" + CRLF

	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Espacos Entre os Totais e as Bases                           ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	IF !( lTerminal )
		cHtml += 	'<tr>'
		cHtml += 		'<td class="tdPrinc"></td>'
		cHtml += 		'<td class="td18_94_AlignR">&nbsp;&nbsp</td>'
		cHtml += 		'<td class="td18_95_AlignR">&nbsp;&nbsp</td>'
		cHtml += 		'<td class="td18_18_AlignL"></td>'
		cHtml += 	'</tr>'
	Else
		cHtml += '<table width="498" border="0" cellspacing="0" cellpadding="0">' + CRLF
	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Base de Adiantamento                                         ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	If cTipoRot = "2"
		If cBaseAux = "S" .And. nBaseIr # 0
			IF !( lTerminal )
				cHtml +=	'<tr>'
				cHtml +=		'<td class="tdPrinc"><p class="pStyle1"><font color=#000082 face="Courier new" size=2><i>'+STR0058+'</i></p></td></font>' //"Base IR Adiantamento"
				cHtml +=		'<td class="td26_94_AlignR"><p></td>'
				cHtml +=		'<td class="td26_95_AlignR"><p>'+ Transform(nBaseIr,cPict1)+'</td>'
				cHtml +=		'<td class="td26_18_AlignL"><p></td>'
				cHtml += 	'</tr>'
			Else
				cHtml += '<tr>'
				cHtml += '<td width="304" class="etiquetas">' + STR0058 + ' + </td>' + CRLF
				cHtml += '<td width="103" class="dados"><div align="center">' + Transform(nBaseIr,cPict3) + '</div></td>' + CRLF
				cHtml += '<td width="91"  class="dados"><div align="center">' + Transform(0.00   ,cPict3) + '</div></td>' + CRLF
				cHtml += '</tr>'
			EndIF
		Endif
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Base de Folha e de 13o 20 Parc.                              ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	ElseIf cTipoRot = "1" .Or. cTipoRot = "6"

		IF cBaseAux = "S"

			IF !( lTerminal )

				cHtml += '<tr>'
				cHtml +=	'<td class="tdPrinc">'
				cHtml +=    '<p class="pStyle1">'+ STR0056 +'</p></td>'//"Base FGTS/Valor FGTS"
				cHtml +=	'<td class="td26_94_AlignR">' + Transform(nBaseFgts,cPict3)+'</td>'
				cHtml +=	'<td class="td26_95_AlignR">' + Transform(nFgts    ,cPict3)+'</td>'
				cHtml += '</tr>'
				cHtml += '<tr>'
				cHtml +=	'<td class="tdPrinc">'
				cHtml +=    '<p class="pStyle1">'+ STR0057 +'</p></td>'//"Base IRRF Folha/Ferias"
				cHtml +=	'<td class="td26_94_AlignR">' + Transform(nBaseIr,cPict3)+'</td>'
				cHtml +=	'<td class="td26_95_AlignR">' + Transform(nBaseIrfe,cPict3)+'</td>'
				cHtml += '</tr>'

			Else

				cHtml += 								"<tr>"
				cHtml += 									"<td width=219' bgcolor='#FAFBFC' class='etiquetas'>"
				cHtml +=										STR0056 + CRLF //"Base FGTS/Valor FGTS"
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='45' bgcolor='#FAFBFC' class='dados'>" + CRLF
				cHtml += 										'<div align="left" class="etiquetas"> </div>' + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='127' bgcolor='#FAFBFC' class='dados'>" + CRLF
				cHtml +=										"<div align='right'>" + Transform(nBaseFgts,cPict3) + "</div>" + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='127'  bgcolor='#FAFBFC' class='dados'>" + CRLF
				cHtml +=										"<div align='right'>" + Transform(nFgts    ,cPict3) + "</div>" + CRLF
				cHtml +=									'</td>' + CRLF
				cHtml += 									"<td width='107' valign='top' bgcolor='#FAFBFC'>" + CRLF
				cHtml += 										"<div align='right'><span class='dados'></span></div>" + CRLF
				cHtml += 									"</td>" + CRLF
				cHtml += 								"</tr>" + CRLF

				cHtml += 								"<tr>" + CRLF
				cHtml += 									"<td width='219' class='etiquetas'>"
				cHtml +=										STR0057 + CRLF //"Base IRRF Folha/Ferias"
				cHtml += 									"</td>" + CRLF
				cHtml += 									"<td width='45' class='dados'>" + CRLF
				cHtml += 										'<div align="left" class="etiquetas"> </div>' + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='127' class='dados'>" + CRLF
				cHtml +=											"<div align='right'>" + Transform(nBaseIr,cPict3) + "</div>" + CRLF
				cHtml += 									"</td>" + CRLF
				cHtml += 									"<td width='127'  class='dados'>"  + CRLF
				cHtml += 										"<div align='right'>" + Transform(nBaseIrFe,cPict3) + "</div>" + CRLF
				cHtml += 									"</td>" + CRLF
				cHtml += 									"<td width='107' class='dados'>" + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 								'</tr>'

				cHtml += 								"<tr>" + CRLF
				cHtml += 									"<td width='219' class='etiquetas' bgcolor='#FAFBFC' >"
				cHtml +=										STR0116 + CRLF //"Base INSS"
				cHtml += 									"</td>" + CRLF
				cHtml += 									"<td width='45' class='dados'>" + CRLF
				cHtml += 										'<div align="left" class="etiquetas" bgcolor="#FAFBFC"> </div>' + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='127' class='dados' bgcolor='#FAFBFC' >" + CRLF
				cHtml +=											"<div align='right'>" + Transform(nAteLim,cPict3) + "</div>" + CRLF
				cHtml += 									"</td>" + CRLF
				cHtml += 									"<td width='127'  class='dados' bgcolor='#FAFBFC' >"  + CRLF
				cHtml += 										"<div align='right'></div>" + CRLF
				cHtml += 									"</td>" + CRLF
				cHtml += 									"<td width='107' class='dados' bgcolor='#FAFBFC' >" + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 								'</tr>'

			EndIF

		EndIF
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Bases de FGTS e FGTS Depositado da 1¦ Parcela                ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	ElseIf cTipoRot = "5"

		If cBaseAux = "S"

			IF !( lTerminal )

				cHtml += 	'<tr>'
				cHtml += 		'<td class="tdPrinc">'
				cHtml +=		'<p class="pStyle1">'+ STR0056 +'</td>' //"Base FGTS / Valor FGTS"
				cHtml += 		'<td class="td26_94_AlignL">' + Transform(nBaseFgts,cPict1) +'</td>'
				cHtml += 		'<td class="td26_95_AlignL">' + Transform(nFgts,cPict2)+'</td>'
				cHtml +=		'<td align=right height="26" width="95"  style="border-left: 0px solid #FF9B06; border-right:0px solid #FF9B06; border-bottom:1px solid #FF9B06 ; border-top: 0px solid #FF9B06 bgcolor=#6F9ECE"></td>'
				cHtml += 	'</tr>'

			Else

				cHtml += 								"<tr>"
				cHtml += 									"<td width=219' bgcolor='#FAFBFC' class='etiquetas'>"
				cHtml +=										STR0056 + CRLF //"Base FGTS/Valor FGTS"
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='45' bgcolor='#FAFBFC' class='dados'>" + CRLF
				cHtml += 										'<div align="left" class="etiquetas"> </div>' + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='127' bgcolor='#FAFBFC' class='dados'>" + CRLF
				cHtml +=										"<div align='right'>" + Transform(nBaseFgts,cPict3) + "</div>" + CRLF
				cHtml +=									"</td>" + CRLF
				cHtml += 									"<td width='127'  bgcolor='#FAFBFC' class='dados'>" + CRLF
				cHtml +=										"<div align='right'>" + Transform(nFgts    ,cPict3) + "</div>" + CRLF
				cHtml +=									'</td>' + CRLF
				cHtml += 									"<td width='107' valign='top' bgcolor='#FAFBFC'>" + CRLF
				cHtml += 										"<div align='right'><span class='dados'></span></div>" + CRLF
				cHtml += 									"</td>" + CRLF
				cHtml += 								"</tr>" + CRLF

			EndIF

		Endif

	EndIF

	IF !( lTerminal )

		cHtml += '</font></i></b>'
		cHtml += '</TBody>'
		cHtml += '</table>'
		cHtml += '</center>'
		cHtml += '</div>'
		cHtml += '<hr whidth = 100% align=right color="#FF812D">'
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Espaco para Observacoes/mensagens                            ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		cHtml += '<!Mensagem>'
		cHtml += '<Table bgColor=#6F9ECE border=0 cellPadding=0 cellSpacing=0 height=100 width=598>'
		cHtml += 	'<TBody>'
		cHtml +=	'<tr>'
		cHtml +=	'<td align=left height=18 width=574 style="border-left:1px solid #FF9B06; border-right:1px solid #FF9B06; border-bottom: 0px solid #FF9B06 ; border-top:1px solid #FF9B06 bgcolor=#6F9ECE"><i><font face="Arial" size="2" color="#000082">'+DESC_MSG1+ '</font></td></tr>'
		cHtml +=	'<tr>'
		cHtml +=	'<td align=left height=18 width=574 style="border-left:1px solid #FF9B06; border-right:1px solid #FF9B06; border-bottom: 0px solid #FF9B06 ; border-top: 0px solid #FF9B06 bgcolor=#6F9ECE"><i><font face="Arial" size="2" color="#000082">'+DESC_MSG2+ '</font></td></tr>'
		cHtml +=	'<tr>'
		cHtml += 	'<td align=left height=18 width=574 style="border-left:1px solid #FF9B06; border-right:1px solid #FF9B06; border-bottom:1px solid #FF9B06 ; border-top: 0px solid #FF9B06 bgcolor=#6F9ECE"><i><font face="Arial" size="2" color="#000082">'+DESC_MSG3+ '</font></td></tr>'
		IF cMesComp == Month(SRA->RA_NASC)
			cHtml += '<TD align=left height=18 width=574 bgcolor="#FFFFFF"><EM><B><CODE>      <font face="Arial" size="4" color="#000082">'
			cHtml += '<MARQUEE align="middle" bgcolor="#FFFFFF">' + STR0059	+ '</marquee><code></b></font></td></tr>' //"F E L I Z &nbsp;&nbsp  A N I V E R S A R I O !!!! "
		EndIF
		cHtml += '</TBody>'
		cHtml += '</Table>'
		cHtml += '</table>'
		cHtml += '</body>'
		cHtml += '</html>'

	Else

		cHtml +=							"</TR>" + CRLF
		cHtml +=						"</TBODY>" + CRLF
		cHtml +=					"</TABLE>" + CRLF

		cHtml +=				"</TBODY>" + CRLF
		cHtml +=			"</TABLE>" + CRLF

		//Separador
		cHtml +=			"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
		cHtml +=				"<TBODY>" + CRLF
		cHtml +=					"<TR>" + CRLF
		cHtml +=						"<TD vAlign=top width='100%' height=10>" + CRLF
		cHtml +=						"</TD>" + CRLF
		cHtml +=			 		"</TR>" + CRLF
		cHtml +=				"</TBODY>" + CRLF
		cHtml +=			"</TABLE>" + CRLF

		//Rodape
		cHtml += 			RodaHtml()

		cHtml += 		'</TABLE>' + CRLF
		cHtml += 		'<p align="right"><a href="javascript:self.print()"><img src="imagens/imprimir.gif" width="90" height="28" hspace="20" border="0"></a></p>' + CRLF
		cHtml += 	'</body>' + CRLF
		cHtml += '</html>' + CRLF

	EndIF

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Envia e-mail p/funcionario                                   ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	IF !( lTerminal )
		lEnvioOK := GPEMail(cSubject,cHtml,cEMail)
	EndIF

	RestArea( aSvArea )

Return( IF( lTerminal , cHtml , NIL ) )

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fImpTeste ºAutor  ³R.H. - Natie        º Data ³  11/29/01   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Testa impressao de Formulario Teste                         º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static function fImpTeste(cString,nTipoRel)

	//--Comando para nao saltar folha apos o MsFlush.
	SetPgEject(.F.)

	@ PROW(),PCOL() PSAY ""
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Descarrega teste de impressao                                ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	MS_Flush()
	fInicia(cString,nTipoRel)

	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Define o Li com a a linha de impressão correten para não saltar linhas no teste  ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	li := _Prow()

	If nTipoRel == 2
		@ LI,00 PSAY AvalImp(Limite)
	Endif

	lRetCanc	:= Pergunte("GPR30A",.T.)

	Vez := If(nTipRel = 1,1,0)

Return Vez

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³fInicia   ºAutor  ³Natie               º Data ³  04/12/01   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Inicializa parametros para impressao                        º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ AP5                                                        º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function  fInicia(cString,nTipoRel)

	If LastKey() = 27 .Or. nLastKey = 27
		Return  .F.
	Endif

	If nTipoRel# 3
		SetDefault(aReturn,cString)
	Endif

	If LastKey() = 27 .OR. nLastKey = 27
		Return .F.
	Endif

Return .T.

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o	   ³CabecHtml  		³Autor³Marinaldo de Jesus ³ Data ³18/09/2003³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Retorna Cabecalho HTML para o RHOnLine                      ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Retorno   ³cHtml  														³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso	   ³GPER030       										    	³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Static Function CabecHtml( cReferencia , dDataPagto , dDataRef )

	Local cHtml 		:= ""
	Local cLogoEmp		:= RetLogoEmp()
	Local nSalario		:= 0
	Local cCodFunc		:= ""		//-- codigo da Funcao do funcionario
	Local cDescFunc		:= ""		//-- Descricao da Funcao do Funcionario

	nSalario := fBuscaSal( dDataRef )
	IF ( nSalario == 0 )
		nSalario := SRA->RA_SALARIO
	EndIf

	DEFAULT cReferencia	:= ""

	/*ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	³ Carrega Funcao do Funcion. de acordo com a Dt Referencia     ³
	ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
	fBuscaFunc(dDataRef, @cCodFunc, @cDescFunc  )

	//Logo e Titulo
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY class='fundo'>"
	cHtml +=			"<img src='" + cLogoEmp +"' width='206' height='030' align=left hspace=30>" + CRLF
	cHtml +=					"<b>" + CRLF
	cHtml += 						"<span class='titulo_opcao'>" + Capital( STR0044 ) + "</span>" + CRLF //DEMONSTRATIVO DE PAGAMENTO
	cHtml +=					"</b>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Empresa
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0097 + CRLF //"Empresa: "
	cHtml += 						"</span>" + CRLF
	cHtml +=	        			 "<span class='dados'>" + CRLF
	cHtml +=								Capital( AllTrim( Desc_Fil ) ) + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Endereco e CNPJ
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='65%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0098 + CRLF //"Endereço:"
	cHtml +=						"</span>" + CRLF
	cHtml +=						"<span class='dados'>"
	cHtml +=								Capital( AllTrim( Desc_End ) ) + "</span>" + CRLF
	cHtml +=						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='35%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0099 + CRLF	//"CNPJ:"
	cHtml +=						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Transform( Desc_CGC , "@R 99.999.999/9999-99") + CRLF
	cHtml +=						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Data do Credito e Conta Corrente
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=				"<TD vAlign=top width='40%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0101 + CRLF //"Crédito em:"
	cHtml +=						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Dtoc(dDataPagto) + CRLF
	cHtml +=						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='60%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0102 + CRLF //"Banco/Agência/Conta:"
	cHtml +=						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								AllTrim( Transform( SRA->RA_BCDEPSA , "@R 999/999999" ) ) + "/" + SRA->RA_CTDEPSA + CRLF
	cHtml +=						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Referencia
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" +  STR0100 + CRLF //"Referência:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								cReferencia + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=5>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Nome e Matricula
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='75%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0105 + CRLF //"Nome:
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Capital( AllTrim( SRA->RA_NOME ) ) + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='25%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0106 + CRLF //"Matricula:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								SRA->RA_MAT + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//CTPS, Serie e CPF
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0107 + CRLF	//"CTPS:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=							SRA->RA_NUMCP + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='100' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0108 + CRLF //"Série:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								SRA->RA_SERCP + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='172' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0109 + CRLF //"CPF:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Transform( SRA->RA_CIC , "@R 999.999.999-99" ) + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='60%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0103  + CRLF //Funcao
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Capital( AllTrim( cDescFunc ) ) + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='40%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0104 + CRLF //Salário Nominal:
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Transform( nSalario , cPict1 ) + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Centro de Custo
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0110 + CRLF //Centro de Custo:
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								AllTrim( SRA->RA_CC ) + " - " + Capital( AllTrim(fDesc("SI3",SRA->RA_CC,"I3_DESC",TamSx3("I3_DESC")[1]) ) ) + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Separador
	cHtml +=	"<TABLE border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#FFFFFF' bordercolordark='#FFFFFF'bordercolorlight='#FFFFFF' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='100%' height=1>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=	 		"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

	//Admissao
	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top width='329' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0111 + CRLF //"Admissão:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								Dtoc( SRA->RA_ADMISSA ) + CRLF
	cHtml +=						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='231' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0112 + CRLF //"Dependente(s) IR:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								SRA->RA_DEPIR + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=				"<TD vAlign=top width='390' height=1>" + CRLF
	cHtml +=					"<P align=left>" + CRLF
	cHtml +=						"<span class='etiquetas'>" + STR0113 + CRLF //"Dependente(s) Salário Família:"
	cHtml += 						"</span>" + CRLF
	cHtml +=						"<span class='dados'>" + CRLF
	cHtml +=								SRA->RA_DEPSF + CRLF
	cHtml += 						"</span>" + CRLF
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

Return( cHtml )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o	   ³RodaHtml  		³Autor³Marinaldo de Jesus ³ Data ³18/09/2003³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Retorna Rodape HTML para o RHOnLine                         ³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Retorno   ³cHtml  														³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso	   ³GPER030       										    	³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Static Function RodaHtml()

	Local cHtml	:= ""

	cHtml +=	"<TABLE border='2' cellpadding='0' cellspacing='0' style='border-collapse: collapse' bordercolor='#111111' width='100%' id='AutoNumber1'>" + CRLF
	cHtml +=		"<TBODY>" + CRLF
	cHtml +=			"<TR>" + CRLF
	cHtml +=				"<TD vAlign=top height=1>" + CRLF
	cHtml +=					"<P align=center>" + CRLF
	cHtml += 							STR0114 + CRLF //'"Válido como Comprovante Mensal de Rendimentos"'
	cHtml +=						"<br>" + CRLF
	cHtml += 							STR0115 + CRLF //"( Artigo no. 41 e 464 da CLT, Portaria MTPS/GM 3.626 de 13/11/1991 )"
	cHtml +=					"</P>" + CRLF
	cHtml +=				"</TD>" + CRLF
	cHtml +=			"</TR>" + CRLF
	cHtml +=		"</TBODY>" + CRLF
	cHtml +=	"</TABLE>" + CRLF

Return( cHtml )

/*
ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿
³Fun‡…o	   ³fMontaDtTcf 	³Autor³Ricardo Duarte     ³ Data ³13/08/2004³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´
³Descri‡…o ³Retorna a data valida para a consulta do Terminal Consulta  ³
³          ³do Funcionario                                         		³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Sintaxe   ³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Parametros³<Vide Parametros Formais>									³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Retorno   ³cHtml  														³
ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
³Uso	   ³GPER030       										    	³
ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ*/
Static Function fMontaDtTcf(cMesAno,nDia)

	Local dDataValida
	Default nDia := 0

	dDataValida := stod(right(cMesAno,4)+left(cMesAno,2)+"01")
	dDataValida := stod(right(cMesAno,4)+left(cMesAno,2)+strzero(f_UltDia(dDataValida),2))+nDia

return(dDataValida)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o	 ³f030Roteiro³ Autor ³ Tatiane Matias        ³ Data ³ 28/02/05 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³Selecionar o Roteiro                               		   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe	 ³ f030Roteiro()											   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 												   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß/*/
User Function f030Roteiro(l1Elem, lTipoRet, lVExtras)

	Local cTitulo	:="Roteiro de Calculo"
	Local nFor		:= 0
	Local nElem		:= 0
	Local MvPar
	Local MvParDef	:=""
	Local MvRetor	:= ""

	Private aSit:={}
	l1Elem := If (l1Elem = Nil , .F. , .T.)

	DEFAULT lTipoRet 	:= .T.
	DEFAULT lVExtras	:= .T.

	cAlias := Alias() 					// Salva Alias Anterior

	IF lTipoRet
		MvPar:=&(Alltrim(ReadVar()))	// Carrega Nome da Variavel do Get em Questao
		mvRet:=Alltrim(ReadVar())		// Iguala Nome da Variavel ao Nome variavel de Retorno
	EndIF

	dbSelectArea("SRY")
	If dbSeek(cFilial)
		CursorWait()
		While !Eof() .And. SRY->RY_FILIAL == cFilial
			If !(SRY->RY_TIPO $ "3*4")
				Aadd(aSit, SRY->RY_CALCULO + " - " + Alltrim(SRY->RY_DESC))
				MvParDef += SRY->RY_CALCULO
			EndIf
			dbSkip()
		Enddo
		If lVExtras
			Aadd(aSit, "EXT - Valores Extras")
			MvParDef += "EXT"
		EndIf
		CursorArrow()
	Endif

	IF lTipoRet
		IF f_Opcoes(@MvPar,cTitulo,aSit,MvParDef,,,l1Elem, GetSx3Cache("RY_CALCULO","X3_TAMANHO"))  // Chama funcao f_Opcoes
			CursorWait()
			For nFor := 1 To Len( mVpar ) Step 3
				IF ( SubStr( mVpar , nFor , 3 ) # "***" )
					mvRetor += SubStr( mVpar , nFor , 3 )
				Endif
			Next nFor
			&MvRet := Mvretor
			CursorArrow()
		EndIF
	EndIF

	dbSelectArea(cAlias) // Retorna Alias

Return( IF( lTipoRet , .T. , MvParDef ) )

/**
*
* @author: Denar Terrazas Parada
* @since: 09/05/2019
* @description: Funcion que devuelve el saldo de vacaciones
* @parametro: cSuc -> Sucursal del empleado
cMat -> Matricula del empleado
*/
static function saldoVac(cSuc, cMat)
	Local aArea:= getArea()
	Local nRet:= 0
	Local OrdenConsul	:= GetNextAlias()
	// consulta a la base de datos
	BeginSql Alias OrdenConsul
		SELECT (COALESCE(SUM(RF_DFERVAT),0) + COALESCE(SUM(RF_DFERAAT),0) - COALESCE(SUM(R8_DURACAO),0)) SALDO
		FROM %table:SRF% SRF
		LEFT JOIN %table:SR8% SR8 ON SRF.RF_FILIAL = SR8.R8_FILIAL AND SRF.RF_MAT = SR8.R8_MAT AND SR8.%notdel%
		WHERE RF_FILIAL = %exp:cSuc%
		AND RF_MAT = %exp:cMat%
		AND SRF.%notdel%
	EndSql
	DbSelectArea(OrdenConsul)
	aObjCondPg := {}
	If (OrdenConsul)->(!Eof())
		nRet:= (OrdenConsul)->SALDO
	endIf
	restArea(aArea)
return nRet
/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ AjustaSx1     ³ Autor ³ Kelly Soares     ³ Data ³27/06/2008³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Ajusta grupo de perguntas GPER101.                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ gper101                                                    ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function AjustaSx1()

	Local aRegs		:= {}
	Local aHelp 	:= {}
	Local aHelpE 	:= {}
	Local aHelpI 	:= {}
	Local cHelp		:= ""

	aHelp 	:= {"Informe o Processo que deseja ",;
	"considerar para impressão do  ",;
	"relatório.                    "}

	aHelpE	:= {"Informe el Proceso que desea ",;
	"considerar para imprimir el  ",;
	"informe.					  "}

	aHelpI	:= {"Enter the Process to consider ",;
	"while printing the report.    "}

	Aadd(aRegs,{cPerg,"01","Processo  ?","¿Proceso  ?","Process   ?","MV_CH1","C",5,0,0,"G","Gpr040Valid(mv_par01)","MV_PAR01","","","","","","","","","","","","","","","","","","","","","","","","","RCJ","S","",aHelp,aHelpI,aHelpE,cHelp})

	aHelp 	:= {"Informe o Roteiro que deseja ",;
	"considerar para impressão do  ",;
	"relatório.                    "}

	aHelpE	:= {"Informe el Procedimiento que  ",;
	"desea considerar para imprimir ",;
	"el informe.					"}

	aHelpI	:= {"Enter the Procedure to consider",;
	"while printing the report.     "}

	Aadd(aRegs,{cPerg,"02","Roteiro  ?","¿Procedimiento  ?","Procedure  ?","MV_CH2","C",3,0,0,"G","f030Roteiro()","MV_PAR02","","","","","","","","","","","","","","","","","","","","","","","","","SRY","S","",aHelp,aHelpI,aHelpE,cHelp})

	aHelp 	:= {"Informe o Período que deseja ",;
	"considerar para impressão do  ",;
	"relatório.                    "}

	aHelpE	:= {"Informe el Periodo que desea ",;
	"considerar para imprimir el  ",;
	"informe.					  "}

	aHelpI	:= {"Enter the Period to consider ",;
	"while printing the report.    "}

	Aadd(aRegs,{cPerg,"03","Periodo  ?","¿Periodo  ?","Period  ?","MV_CH3","C",6,0,0,"G","Gpr040Valid(mv_par01 + mv_par02 + mv_par03)","MV_PAR03","","","","","","","","","","","","","","","","","","","","","","","","","RCH","S","",aHelp,aHelpI,aHelpE,cHelp})

	aHelp 	:= {"Informe o Numero de Pagamento",;
	"que deseja considerar para   ",;
	"impressão do relatório.      "}

	aHelpE	:= {"Informe el Numero Pago que    ",;
	"desea considerar para imprimir ",;
	"el informe.					"}

	aHelpI	:= {"Enter the Payment Number to  ",;
	"consider  while printing the ",;
	"report.    "}

	Aadd(aRegs,{cPerg,"04","Numero de Pagamento  ?","¿Numero Pago  ?","Payment Number ?","MV_CH4","C",2,0,0,"G","Gpr040Valid(mv_par01 + mv_par02 + mv_par03 + mv_par04)","MV_PAR04","","","","","","","","","","","","","","","","","","","","","","","","","RCH01","S","",aHelp,aHelpI,aHelpE,cHelp})

	cHelp := ".RHMATD."
	Aadd(aRegs,{cPerg,"10","Matricula De  ?","¿De Matricula  ?","From Registration  ?","MV_CHA","C",6,0,0,"G","","MV_PAR10","","","","","","","","","","","","","","","","","","","","","","","","","SRA","S","",aHelp,aHelpI,aHelpE,cHelp})

	cHelp := ".RHMATA."
	Aadd(aRegs,{cPerg,"11","Matricula Até  ?","¿A Matricula  ?","To Registration  ?","MV_CHB","C",6,0,0,"G","NaoVazio()","MV_PAR11","","","","","","","","","","","","","","","","","","","","","","","","","SRA","S","",aHelp,aHelpI,aHelpE,cHelp})

	cHelp := ""

	aHelp 	:= {"Informe a mensagem que deseja",;
	"deseja considerar para impressão",;
	"do relatório.      "}

	aHelpE	:= {"Informe el mensaje que desea ",;
	"considerar para imprimir el ",;
	"informe.					"}

	aHelpI	:= {"Enter the message to  ",;
	"consider while printing",;
	"the report.    "}

	Aadd(aRegs,{cPerg,"16","Mensagem 1  ?","¿Mensaje 1  ?","Message 1  ?","MV_CHG","C",3,0,0,"G","","MV_PAR16","","","","","","","","","","","","","","","","","","","","","","","","","X06","S","",aHelp,aHelpI,aHelpE,cHelp})
	Aadd(aRegs,{cPerg,"17","Mensagem 2  ?","¿Mensaje 2  ?","Message 2  ?","MV_CHH","C",3,0,0,"G","","MV_PAR17","","","","","","","","","","","","","","","","","","","","","","","","","X06","S","",aHelp,aHelpI,aHelpE,cHelp})
	Aadd(aRegs,{cPerg,"18","Mensagem 3  ?","¿Mensaje 3  ?","Message 3  ?","MV_CHI","C",3,0,0,"G","","MV_PAR18","","","","","","","","","","","","","","","","","","","","","","","","","X06","S","",aHelp,aHelpI,aHelpE,cHelp})

	aHelp 	:= {"Informe se deseja imprimir ",;
	"as bases utilizadas para o ",;
	"cálculo do pagamento.      "}

	aHelpE	:= {"Indique si desea imprimir ",;
	"las bases utilizadas para ",;
	"el calculo del pago.      "}

	aHelpI	:= {"Inform if you want to print",;
	"the bases used to calculate",;
	"the payment.               "}

	Aadd(aRegs,{cPerg,"21","Imprime Bases  ?","¿Imprime Bases  ?","Print Base  ?","MV_CHL","C",1,0,0,"C","","MV_PAR21","Sim","Si","Yes","","","Não","No","No","","","","","","","","","","","","","","","","","","S","",aHelp,aHelpI,aHelpE,cHelp})

	ValidPerg(aRegs,cPerg,.T.)

return

/**
*
* @author: Denar Terrazas Parada
* @since: 11/05/2020
* @description: Funcion que devuelve aumenta los valores agrupados al array aProve y aDesco
* @parametro: N/A
*/
Static Function getValoresAgrupados()
	/* Validacion para Obtener los conceptos Tipo 1 PERIODO CERRADO*/
	// R_E_M_U_N_E_R_A_C_I_O_N_

	aArea := GetArea()
	dbSelectArea("SRV")
	If Len(aPerFechado) > 0
		cQryRV := "QSRD"
		cQry := "SELECT DISTINCT ISNULL(SUM(RD_VALOR),0) VALOR "
		cQry += "FROM " + RetSqlName("SRD") + " SRD LEFT JOIN " +  RetSqlName ("SRV") + " SRV ON  "
		cQry += "RD_PD = RV_COD "
		cQry += "AND SRV.D_E_L_E_T_ = '' "
		cQry += "WHERE SRD.D_E_L_E_T_ = '' "
		cQry += "AND RV_UAGRBOL = '1' "
		cQry += "AND RD_MAT = '" + SRA->RA_MAT + "'"
		cQry += "AND RD_PERIODO = (SELECT TOP 1 RD_PERIODO FROM SRD010 SRD WHERE SRD.D_E_L_E_T_ = '' ORDER BY RD_PERIODO DESC) "
		cQry += "AND RV_TIPOCOD = 1 "
		cQry += "AND RD_ROTEIR = 'FOL' "
		cQry := ChangeQuery(cQry)
		//Aviso("query",cvaltochar(cQry`````),{"si"})
		dbUseArea( .T., 'TOPCONN', TCGENQRY(,,cQry), cQryRV, .F., .T.)
		dbSelectArea(cQryRV)
		nValor := (cQryRV)->VALOR
		(cQryRV)->(dbCloseArea())
		If nvalor > 0
			aadd(aProve,{ cIngrPD + " " + cIngresos,0,nValor })
		Endif

		RestArea(aArea)
	Endif

	/* Validacion para Obtener los conceptos Tipo 1 PERIODO ABIERTO*/
	// R_E_M_U_N_E_R_A_C_I_O_N_

	If Len(aPerAberto) > 0
		cQryRV := "QSRC"
		cQry := "SELECT DISTINCT ISNULL(SUM(RC_VALOR),0) VALOR "
		cQry += "FROM " + RetSqlName("SRC") + " SRC LEFT JOIN " +  RetSqlName ("SRV") + " SRV ON  "
		cQry += "RC_PD = RV_COD "
		cQry += "AND SRV.D_E_L_E_T_ = '' "
		cQry += "WHERE SRC.D_E_L_E_T_ = '' "
		cQry += "AND RV_UAGRBOL = '1' "
		cQry += "AND RC_MAT = '" + SRA->RA_MAT + "'"
		cQry += "AND RC_PERIODO = (SELECT TOP 1 RC_PERIODO FROM SRC010 SRC WHERE SRC.D_E_L_E_T_ = '' ORDER BY RC_PERIODO DESC) "
		cQry += "AND RV_TIPOCOD = 1 "
		cQry += "AND RC_ROTEIR = 'RET' "
		cQry := ChangeQuery(cQry)
		//Aviso("query",cvaltochar(cQry`````),{"si"})
		dbUseArea( .T., 'TOPCONN', TCGENQRY(,,cQry), cQryRV, .F., .T.)
		dbSelectArea(cQryRV)
		nValor := (cQryRV)->VALOR
		(cQryRV)->(dbCloseArea())

		If nvalor > 0
			aadd(aProve,{ cIngrPD + " " + cIngresos,0,nValor })
		Endif

		RestArea(aArea)

	Endif

	/* Validacion para Obtener los conceptos Tipo 2 PERIODO CERRADO*/
	// D_E_S_C_U_E_N_T_O_S_

	aArea := GetArea()
	dbSelectArea("SRV")
	If Len(aPerFechado) > 0
		cQrySRV := "QSRD"
		cQry := "SELECT DISTINCT ISNULL(SUM(RD_VALOR),0) VALOR "
		cQry += "FROM " + RetSqlName("SRD") + " SRD LEFT JOIN " +  RetSqlName ("SRV") + " SRV ON  "
		cQry += "RD_PD = RV_COD "
		cQry += "AND SRV.D_E_L_E_T_ = '' "
		cQry += "WHERE SRD.D_E_L_E_T_ = '' "
		cQry += "AND RV_UAGRBOL = '1' "
		cQry += "AND RD_MAT = '" + SRA->RA_MAT + "'"
		cQry += "AND RD_PERIODO = (SELECT TOP 1 RD_PERIODO FROM SRD010 SRD WHERE SRD.D_E_L_E_T_ = '' ORDER BY RD_PERIODO DESC) "
		cQry += "AND RV_TIPOCOD = 2 "
		cQry += "AND RD_ROTEIR = 'FOL' "
		cQry := ChangeQuery(cQry)
		//Aviso("query",cvaltochar(cQry`````),{"si"})
		dbUseArea( .T., 'TOPCONN', TCGENQRY(,,cQry), cQrySRV, .F., .T.)
		dbSelectArea(cQrySRV)
		nVal2 := (cQrySRV)->VALOR
		(cQrySRV)->(dbCloseArea())
		If nVal2 > 0
			aadd(aDesco,{ cDescPd + " " + cDescuento,0,nVal2 })
		Endif

		RestArea(aArea)
	Endif

	/* Validacion para Obtener los conceptos Tipo 2 PERIODO ABIERTO*/
	// D_E_S_C_U_E_N_T_O_S_

	aArea := GetArea()
	dbSelectArea("SRC")
	If Len(aPerFechado) > 0
		cQrySRV := "QSRC"
		cQry := "SELECT DISTINCT ISNULL(SUM(RC_VALOR),0) VALOR "
		cQry += "FROM " + RetSqlName("SRC") + " SRC LEFT JOIN " +  RetSqlName ("SRV") + " SRV ON  "
		cQry += "RC_PD = RV_COD "
		cQry += "AND SRV.D_E_L_E_T_ = '' "
		cQry += "WHERE SRC.D_E_L_E_T_ = '' "
		cQry += "AND RV_UAGRBOL = '1' "
		cQry += "AND RC_MAT = '" + SRA->RA_MAT + "'"
		cQry += "AND RC_PERIODO = (SELECT TOP 1 RC_PERIODO FROM SRC010 SRC WHERE SRC.D_E_L_E_T_ = '' ORDER BY RC_PERIODO DESC) "
		cQry += "AND RV_TIPOCOD = 2 "
		cQry += "AND RC_ROTEIR = 'FOL' "
		cQry := ChangeQuery(cQry)
		//Aviso("query",cvaltochar(cQry`````),{"si"})
		dbUseArea( .T., 'TOPCONN', TCGENQRY(,,cQry), cQrySRV, .F., .T.)
		dbSelectArea(cQrySRV)
		nVal2 := (cQrySRV)->VALOR
		(cQrySRV)->(dbCloseArea())
		If nVal2 > 0
			aadd(aDesco,{ cDescPd + " " + cDescuento,0,nVal2 })
		Endif

		RestArea(aArea)
	Endif

return